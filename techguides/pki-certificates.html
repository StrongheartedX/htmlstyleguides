<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PKI &amp; Certificates — Tech Guide</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        /* ================================================================
           PKI & CERTIFICATES
           Stained Glass Design System — Tech Guide
           ================================================================ */

        /* --- CSS VARIABLES / DESIGN TOKENS --- */
        :root {
            /* Typography */
            --font-display: 'Cinzel', serif;
            --font-body: 'Crimson Text', serif;
            --font-mono: 'Share Tech Mono', monospace;

            /* Spacing Scale (4px base) */
            --space-1: 4px;
            --space-2: 8px;
            --space-3: 12px;
            --space-4: 16px;
            --space-5: 24px;
            --space-6: 32px;
            --space-7: 48px;
            --space-8: 64px;
            --space-9: 96px;

            /* Jewel Tones */
            --ruby: #9b111e;
            --ruby-glow: rgba(155, 17, 30, 0.6);
            --ruby-dim: rgba(155, 17, 30, 0.15);
            --sapphire: #0f52ba;
            --sapphire-glow: rgba(15, 82, 186, 0.6);
            --sapphire-dim: rgba(15, 82, 186, 0.15);
            --emerald: #046307;
            --emerald-glow: rgba(4, 99, 7, 0.6);
            --emerald-dim: rgba(4, 99, 7, 0.15);
            --amber: #ffbf00;
            --amber-glow: rgba(255, 191, 0, 0.6);
            --amber-dim: rgba(255, 191, 0, 0.15);
            --amethyst: #9966cc;
            --amethyst-glow: rgba(153, 102, 204, 0.6);
            --amethyst-dim: rgba(153, 102, 204, 0.15);
            --topaz: #ffc87c;
            --topaz-glow: rgba(255, 200, 124, 0.6);

            /* Leading and Structure */
            --leading: #1a1a1a;
            --leading-highlight: #2d2d2d;
            --cathedral-dark: #0a0a0a;
            --cathedral-stone: #3d3d3d;

            /* Light Effects */
            --light-bloom: rgba(255, 255, 255, 0.15);
            --light-ray: rgba(255, 255, 255, 0.08);

            /* Semantic */
            --text-primary: #f0e6d3;
            --text-secondary: rgba(240, 230, 211, 0.7);
            --text-muted: rgba(240, 230, 211, 0.45);
            --bg-primary: var(--cathedral-dark);
            --bg-secondary: var(--leading);

            /* Borders */
            --leading-width: 4px;
            --leading-border: var(--leading-width) solid var(--leading);

            /* Code Block */
            --code-bg: #0d0d14;
            --code-text: #e8e0d0;
            --code-comment: #6a6a6a;
            --code-keyword: var(--amber);
            --code-string: #7ec88b;
            --code-flag: var(--topaz);
            --code-path: var(--amethyst);
            --code-value: #e06c75;
        }

        /* --- BASE RESET --- */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
            scroll-padding-top: 52px;
        }

        body {
            font-family: var(--font-body);
            font-size: 1.125rem;
            font-weight: 400;
            line-height: 1.7;
            color: var(--text-primary);
            background: var(--bg-primary);
            -webkit-font-smoothing: antialiased;
            min-height: 100vh;
        }

        /* --- GLASS TEXTURE OVERLAY --- */
        .glass-texture {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.03;
            pointer-events: none;
            z-index: 1000;
            background-image:
                url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        }

        /* --- LIGHT RAYS BACKGROUND --- */
        .light-rays {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            background:
                radial-gradient(ellipse at 30% 0%, var(--ruby-glow) 0%, transparent 50%),
                radial-gradient(ellipse at 70% 0%, var(--sapphire-glow) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 0%, var(--amber-glow) 0%, transparent 40%);
            opacity: 0.15;
        }

        /* --- CONTAINER --- */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 var(--space-6);
        }

        /* --- BACK LINK --- */
        .back-link {
            display: inline-block;
            font-family: var(--font-display);
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: var(--text-secondary);
            text-decoration: none;
            padding: var(--space-4) 0;
            transition: color 0.3s ease;
            position: relative;
            z-index: 2;
        }

        .back-link:hover {
            color: var(--amber);
            text-shadow: 0 0 10px var(--amber-glow);
        }

        /* --- HEADER / ROSE WINDOW --- */
        .header {
            text-align: center;
            padding: var(--space-8) var(--space-6) var(--space-7);
            margin-bottom: var(--space-5);
            position: relative;
        }

        .header-rose-window {
            width: 100px;
            height: 100px;
            margin: 0 auto var(--space-6);
            position: relative;
            border-radius: 50%;
            background:
                conic-gradient(
                    var(--ruby) 0deg 60deg,
                    var(--sapphire) 60deg 120deg,
                    var(--emerald) 120deg 180deg,
                    var(--amber) 180deg 240deg,
                    var(--amethyst) 240deg 300deg,
                    var(--topaz) 300deg 360deg
                );
            box-shadow:
                inset 0 0 30px rgba(255, 255, 255, 0.3),
                0 0 40px rgba(255, 191, 0, 0.3),
                0 0 2px 2px var(--leading);
        }

        .header-rose-window::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 34px;
            height: 34px;
            border-radius: 50%;
            background: var(--amber);
            box-shadow:
                inset 0 0 15px rgba(255, 255, 255, 0.5),
                0 0 20px var(--amber-glow);
            border: 3px solid var(--leading);
        }

        .header h1 {
            font-family: var(--font-display);
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            background: linear-gradient(180deg, var(--amber) 0%, var(--topaz) 50%, var(--text-primary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-3);
            line-height: 1.2;
        }

        .header .tagline {
            font-family: var(--font-body);
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* --- STICKY JUMP NAV --- */
        .jump-nav {
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            gap: var(--space-1);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            white-space: nowrap;
            background: rgba(10, 10, 10, 0.95);
            border-top: var(--leading-border);
            border-bottom: var(--leading-border);
            padding: var(--space-2) var(--space-3);
            backdrop-filter: blur(10px);
            scrollbar-width: thin;
            scrollbar-color: var(--leading-highlight) transparent;
        }

        .jump-nav::-webkit-scrollbar {
            height: 4px;
        }

        .jump-nav::-webkit-scrollbar-track {
            background: transparent;
        }

        .jump-nav::-webkit-scrollbar-thumb {
            background: var(--leading-highlight);
            border-radius: 2px;
        }

        .jump-nav a {
            font-family: var(--font-display);
            font-size: 0.625rem;
            font-weight: 500;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-secondary);
            text-decoration: none;
            padding: var(--space-2) var(--space-3);
            border: 2px solid var(--leading);
            transition: all 0.3s ease;
            flex-shrink: 0;
            position: relative;
        }

        .jump-nav a:nth-child(6n+1) { border-color: var(--ruby); }
        .jump-nav a:nth-child(6n+2) { border-color: var(--sapphire); }
        .jump-nav a:nth-child(6n+3) { border-color: var(--emerald); }
        .jump-nav a:nth-child(6n+4) { border-color: var(--amber); }
        .jump-nav a:nth-child(6n+5) { border-color: var(--amethyst); }
        .jump-nav a:nth-child(6n+6) { border-color: var(--topaz); }

        .jump-nav a:nth-child(6n+1):hover { background: var(--ruby-dim); color: var(--text-primary); box-shadow: inset 0 0 15px var(--ruby-glow); }
        .jump-nav a:nth-child(6n+2):hover { background: var(--sapphire-dim); color: var(--text-primary); box-shadow: inset 0 0 15px var(--sapphire-glow); }
        .jump-nav a:nth-child(6n+3):hover { background: var(--emerald-dim); color: var(--text-primary); box-shadow: inset 0 0 15px var(--emerald-glow); }
        .jump-nav a:nth-child(6n+4):hover { background: var(--amber-dim); color: var(--text-primary); box-shadow: inset 0 0 15px var(--amber-glow); }
        .jump-nav a:nth-child(6n+5):hover { background: var(--amethyst-dim); color: var(--text-primary); box-shadow: inset 0 0 15px var(--amethyst-glow); }
        .jump-nav a:nth-child(6n+6):hover { background: rgba(255, 200, 124, 0.15); color: var(--text-primary); box-shadow: inset 0 0 15px var(--topaz-glow); }

        /* --- SECTION STRUCTURE --- */
        .section {
            margin-bottom: var(--space-9);
            padding-top: var(--space-6);
        }

        .section-header {
            text-align: center;
            margin-bottom: var(--space-7);
        }

        .section-number {
            font-family: var(--font-display);
            font-size: 0.875rem;
            letter-spacing: 0.3em;
            color: var(--amber);
            opacity: 0.6;
            margin-bottom: var(--space-2);
        }

        .section-title {
            font-family: var(--font-display);
            font-size: clamp(1.5rem, 3vw, 2rem);
            font-weight: 500;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            color: var(--text-primary);
            margin-bottom: var(--space-3);
        }

        .section-description {
            font-family: var(--font-body);
            font-size: 1.05rem;
            color: var(--text-secondary);
            font-style: italic;
            max-width: 600px;
            margin: 0 auto;
            margin-top: var(--space-3);
        }

        .section-divider {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-4);
        }

        .section-divider::before,
        .section-divider::after {
            content: '';
            width: 60px;
            height: 3px;
            background: var(--leading);
        }

        .section-divider .gem {
            width: 12px;
            height: 12px;
            background: var(--amber);
            transform: rotate(45deg);
            box-shadow: inset 0 0 4px rgba(255, 255, 255, 0.4);
            border: 2px solid var(--leading);
        }

        /* --- SUBSECTION --- */
        .subsection {
            margin-bottom: var(--space-7);
        }

        .subsection-title {
            font-family: var(--font-display);
            font-size: 1.15rem;
            font-weight: 600;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--topaz);
            margin-bottom: var(--space-4);
            padding-bottom: var(--space-2);
            border-bottom: 2px solid var(--leading);
        }

        .subsection-intro {
            font-family: var(--font-body);
            font-size: 1.05rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-5);
            line-height: 1.8;
        }

        /* --- GLASS PANEL --- */
        .glass-panel {
            position: relative;
            background: rgba(26, 26, 26, 0.9);
            border: var(--leading-width) solid var(--leading);
            box-shadow:
                inset 0 0 30px var(--light-bloom),
                0 4px 20px rgba(0, 0, 0, 0.5);
            padding: var(--space-6);
            margin-bottom: var(--space-5);
        }

        .glass-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--light-bloom) 0%, transparent 50%);
            pointer-events: none;
        }

        /* --- COMMAND GRID --- */
        .command-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 0;
            border: var(--leading-width) solid var(--leading);
            background: var(--leading);
        }

        .command-card {
            padding: var(--space-5);
            border: 2px solid var(--leading);
            background: rgba(10, 10, 10, 0.95);
            position: relative;
            transition: all 0.3s ease;
        }

        .command-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, var(--light-bloom) 0%, transparent 40%);
            pointer-events: none;
        }

        .command-card:hover {
            box-shadow: inset 0 0 30px var(--amber-glow);
        }

        .command-card-label {
            font-family: var(--font-display);
            font-size: 0.7rem;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--amber);
            margin-bottom: var(--space-2);
        }

        .command-card pre {
            background: var(--code-bg);
            border: 2px solid var(--leading);
            padding: var(--space-3) var(--space-4);
            overflow-x: auto;
            margin: 0;
        }

        .command-card pre code {
            font-family: var(--font-mono);
            font-size: 0.8rem;
            color: var(--code-text);
            line-height: 1.5;
            white-space: pre;
        }

        /* --- CODE BLOCKS --- */
        pre {
            background: var(--code-bg);
            border: var(--leading-width) solid var(--leading);
            padding: var(--space-5);
            overflow-x: auto;
            margin-bottom: var(--space-5);
            position: relative;
            box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.5);
        }

        pre::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--ruby), var(--sapphire), var(--emerald), var(--amber), var(--amethyst));
        }

        pre code {
            font-family: var(--font-mono);
            font-size: 0.85rem;
            color: var(--code-text);
            line-height: 1.7;
            white-space: pre;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.85em;
        }

        /* Inline code */
        p code, li code, td code {
            background: rgba(26, 26, 26, 0.8);
            color: var(--topaz);
            padding: 2px 6px;
            border: 1px solid var(--leading);
            font-size: 0.82em;
        }

        /* Code block scrollbars */
        pre {
            scrollbar-width: thin;
            scrollbar-color: var(--leading-highlight) rgba(0, 0, 0, 0.3);
        }

        pre::-webkit-scrollbar {
            height: 6px;
        }

        pre::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 3px;
        }

        pre::-webkit-scrollbar-thumb {
            background: var(--leading-highlight);
            border-radius: 3px;
        }

        pre::-webkit-scrollbar-thumb:hover {
            background: var(--amber);
        }

        /* Syntax coloring classes */
        .code-comment { color: var(--code-comment); font-style: italic; }
        .code-keyword { color: var(--code-keyword); }
        .code-string { color: var(--code-string); }
        .code-flag { color: var(--topaz); }
        .code-path { color: var(--amethyst); }
        .code-value { color: var(--code-value); }

        /* --- DATA TABLES --- */
        .table-container {
            border: var(--leading-width) solid var(--leading);
            overflow-x: auto;
            margin-bottom: var(--space-5);
            scrollbar-width: thin;
            scrollbar-color: var(--leading-highlight) rgba(0, 0, 0, 0.3);
        }

        .table-container::-webkit-scrollbar {
            height: 6px;
        }

        .table-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 3px;
        }

        .table-container::-webkit-scrollbar-thumb {
            background: var(--leading-highlight);
            border-radius: 3px;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: var(--amber);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--leading);
        }

        .data-table th,
        .data-table td {
            padding: var(--space-3) var(--space-4);
            border: 2px solid var(--leading);
            text-align: left;
            vertical-align: top;
        }

        .data-table th {
            font-family: var(--font-display);
            font-size: 0.75rem;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            background: var(--leading-highlight);
            color: var(--amber);
            white-space: nowrap;
        }

        .data-table td {
            font-family: var(--font-body);
            font-size: 0.95rem;
            background: rgba(10, 10, 10, 0.9);
            color: var(--text-primary);
        }

        .data-table tbody tr:nth-child(odd) td {
            background: rgba(26, 26, 26, 0.9);
        }

        .data-table tbody tr {
            transition: all 0.2s ease;
        }

        .data-table tbody tr:hover td {
            box-shadow: inset 0 0 25px rgba(255, 191, 0, 0.08);
        }

        /* --- ALERT / CALLOUT BOXES --- */
        .alert {
            position: relative;
            padding: var(--space-5);
            margin-bottom: var(--space-5);
            border: var(--leading-width) solid var(--leading);
            background: rgba(26, 26, 26, 0.9);
        }

        .alert::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }

        .alert-title {
            font-family: var(--font-display);
            font-size: 0.8rem;
            font-weight: 600;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            margin-bottom: var(--space-2);
        }

        .alert-body {
            font-family: var(--font-body);
            font-size: 1rem;
            color: var(--text-primary);
            line-height: 1.7;
        }

        .alert-body code {
            background: rgba(10, 10, 10, 0.5);
        }

        /* Ruby - Warning/Important */
        .alert-warning {
            border-left: 6px solid var(--ruby);
        }
        .alert-warning::before {
            box-shadow: inset 0 0 40px var(--ruby-dim);
        }
        .alert-warning .alert-title {
            color: #e85c6a;
        }

        /* Sapphire - Info */
        .alert-info {
            border-left: 6px solid var(--sapphire);
        }
        .alert-info::before {
            box-shadow: inset 0 0 40px var(--sapphire-dim);
        }
        .alert-info .alert-title {
            color: #5b8fd9;
        }

        /* Emerald - Tip/Success */
        .alert-tip {
            border-left: 6px solid var(--emerald);
        }
        .alert-tip::before {
            box-shadow: inset 0 0 40px var(--emerald-dim);
        }
        .alert-tip .alert-title {
            color: #4aad4d;
        }

        /* Amber - Highlight/Note */
        .alert-note {
            border-left: 6px solid var(--amber);
        }
        .alert-note::before {
            box-shadow: inset 0 0 40px var(--amber-dim);
        }
        .alert-note .alert-title {
            color: var(--amber);
        }

        /* --- BADGES --- */
        .badge {
            display: inline-block;
            font-family: var(--font-display);
            font-size: 0.625rem;
            font-weight: 500;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            padding: var(--space-1) var(--space-3);
            border: 2px solid var(--leading);
            color: var(--text-primary);
            position: relative;
            vertical-align: middle;
        }

        .badge::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            box-shadow: inset 0 0 12px currentColor;
            opacity: 0.3;
            pointer-events: none;
        }

        .badge-ruby { background: var(--ruby); color: var(--ruby); }
        .badge-sapphire { background: var(--sapphire); color: var(--sapphire); }
        .badge-emerald { background: var(--emerald); color: var(--emerald); }
        .badge-amber { background: var(--amber); color: var(--amber); }
        .badge-amber span { color: var(--leading); }
        .badge-amethyst { background: var(--amethyst); color: var(--amethyst); }

        .badge span {
            position: relative;
            z-index: 1;
            color: var(--text-primary);
        }

        /* --- FLOW / DIAGRAM BOXES --- */
        .flow-diagram {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: var(--space-3);
            margin-bottom: var(--space-5);
            padding: var(--space-5);
        }

        .flow-box {
            padding: var(--space-3) var(--space-5);
            border: 3px solid var(--leading);
            background: rgba(10, 10, 10, 0.95);
            text-align: center;
            font-family: var(--font-display);
            font-size: 0.8rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--text-primary);
            position: relative;
            min-width: 130px;
        }

        .flow-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, var(--light-bloom) 0%, transparent 50%);
            pointer-events: none;
        }

        .flow-box::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            opacity: 0.25;
        }

        .flow-box-ruby { border-color: var(--ruby); }
        .flow-box-ruby::after { box-shadow: inset 0 0 30px var(--ruby-glow); }
        .flow-box-sapphire { border-color: var(--sapphire); }
        .flow-box-sapphire::after { box-shadow: inset 0 0 30px var(--sapphire-glow); }
        .flow-box-emerald { border-color: var(--emerald); }
        .flow-box-emerald::after { box-shadow: inset 0 0 30px var(--emerald-glow); }
        .flow-box-amber { border-color: var(--amber); }
        .flow-box-amber::after { box-shadow: inset 0 0 30px var(--amber-glow); }
        .flow-box-amethyst { border-color: var(--amethyst); }
        .flow-box-amethyst::after { box-shadow: inset 0 0 30px var(--amethyst-glow); }

        .flow-box .flow-label {
            position: relative;
            z-index: 1;
        }

        .flow-box .flow-sub {
            font-family: var(--font-body);
            font-size: 0.75rem;
            font-style: italic;
            text-transform: none;
            letter-spacing: 0;
            color: var(--text-secondary);
            margin-top: var(--space-1);
        }

        .flow-arrow {
            font-size: 1.5rem;
            color: var(--cathedral-stone);
            flex-shrink: 0;
        }

        .flow-arrow-down {
            width: 100%;
            text-align: center;
            font-size: 1.5rem;
            color: var(--cathedral-stone);
            padding: var(--space-1) 0;
        }

        /* Vertical flow layout */
        .flow-vertical {
            flex-direction: column;
        }

        /* --- SECTION CONTENT WRAPPER --- */
        .section-content {
            position: relative;
        }

        /* Paragraph styling within sections */
        .section-content p {
            margin-bottom: var(--space-4);
            line-height: 1.8;
        }

        .section-content ul,
        .section-content ol {
            margin-bottom: var(--space-4);
            padding-left: var(--space-6);
        }

        .section-content li {
            margin-bottom: var(--space-2);
            line-height: 1.7;
        }

        .section-content li::marker {
            color: var(--amber);
        }

        /* --- COMPARISON PANELS --- */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 0;
            border: var(--leading-width) solid var(--leading);
            background: var(--leading);
            margin-bottom: var(--space-5);
        }

        .comparison-panel {
            padding: var(--space-5);
            border: 2px solid var(--leading);
            background: rgba(10, 10, 10, 0.95);
            position: relative;
        }

        .comparison-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--light-bloom) 0%, transparent 60%);
            pointer-events: none;
        }

        .comparison-panel-title {
            font-family: var(--font-display);
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            margin-bottom: var(--space-4);
            padding-bottom: var(--space-2);
            border-bottom: 2px solid var(--leading);
        }

        .comparison-panel-title.title-emerald { color: var(--emerald); border-color: var(--emerald); }
        .comparison-panel-title.title-ruby { color: #e85c6a; border-color: var(--ruby); }
        .comparison-panel-title.title-sapphire { color: #5b8fd9; border-color: var(--sapphire); }
        .comparison-panel-title.title-amber { color: var(--amber); border-color: var(--amber); }
        .comparison-panel-title.title-amethyst { color: var(--amethyst); border-color: var(--amethyst); }

        .comparison-panel ul {
            list-style: none;
            padding: 0;
        }

        .comparison-panel li {
            padding: var(--space-2) 0;
            border-bottom: 1px solid rgba(26, 26, 26, 0.6);
            font-size: 0.95rem;
            color: var(--text-secondary);
        }

        .comparison-panel li:last-child {
            border-bottom: none;
        }

        /* --- DIVIDER --- */
        .divider {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-5);
            margin: var(--space-8) 0;
            padding: var(--space-4) 0;
        }

        .divider-line {
            flex: 1;
            height: 4px;
            background: var(--leading);
            position: relative;
        }

        .divider-line::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--amber), transparent);
            transform: translateY(-50%);
        }

        .divider-center {
            display: flex;
            gap: var(--space-2);
        }

        .divider-gem {
            width: 12px;
            height: 12px;
            transform: rotate(45deg);
            border: 2px solid var(--leading);
            box-shadow: inset 0 0 6px rgba(255, 255, 255, 0.4);
        }

        .divider-gem:nth-child(1) { background: var(--ruby); }
        .divider-gem:nth-child(2) { background: var(--amber); }
        .divider-gem:nth-child(3) { background: var(--sapphire); }

        /* --- FOOTER --- */
        .site-footer {
            text-align: center;
            padding: var(--space-8) var(--space-6);
            margin-top: var(--space-8);
            border-top: var(--leading-width) solid var(--leading);
            position: relative;
        }

        .site-footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            box-shadow: inset 0 20px 60px rgba(255, 191, 0, 0.05);
            pointer-events: none;
        }

        .footer-icon {
            font-size: 2rem;
            margin-bottom: var(--space-4);
            color: var(--amber);
            text-shadow: 0 0 20px var(--amber-glow);
        }

        .site-footer p {
            font-family: var(--font-body);
            font-style: italic;
            color: var(--text-secondary);
            margin-bottom: var(--space-3);
        }

        .site-footer a {
            font-family: var(--font-display);
            font-size: 0.75rem;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--amber);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .site-footer a:hover {
            text-shadow: 0 0 15px var(--amber-glow);
        }

        /* --- STRONG / EMPHASIS --- */
        strong {
            font-weight: 700;
            color: var(--text-primary);
        }

        em {
            font-style: italic;
            color: var(--text-secondary);
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            .container {
                padding: 0 var(--space-4);
            }

            .header {
                padding: var(--space-6) var(--space-3) var(--space-5);
            }

            .header-rose-window {
                width: 70px;
                height: 70px;
            }

            .header-rose-window::before {
                width: 24px;
                height: 24px;
            }

            .section {
                margin-bottom: var(--space-7);
            }

            .section-header {
                margin-bottom: var(--space-5);
            }

            .section-title {
                font-size: 1.3rem;
                letter-spacing: 0.08em;
            }

            .jump-nav a {
                font-size: 0.55rem;
                padding: var(--space-1) var(--space-2);
            }

            .command-grid {
                grid-template-columns: 1fr;
            }

            .flow-diagram {
                padding: var(--space-3);
            }

            .flow-box {
                min-width: 100px;
                font-size: 0.7rem;
                padding: var(--space-2) var(--space-3);
            }

            .flow-arrow {
                font-size: 1.2rem;
            }

            .glass-panel {
                padding: var(--space-4);
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            pre {
                padding: var(--space-3);
            }

            pre code {
                font-size: 0.75rem;
            }

            .data-table th,
            .data-table td {
                padding: var(--space-2) var(--space-3);
                font-size: 0.85rem;
            }

            .alert {
                padding: var(--space-4);
            }

            .subsection-title {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="light-rays"></div>
    <div class="glass-texture"></div>

    <div class="container">
        <!-- Back Link -->
        <a href="index.html" class="back-link">&larr; Tech Guides</a>

        <!-- Header -->
        <header class="header">
            <div class="header-rose-window"></div>
            <h1>PKI &amp; Certificates</h1>
            <p class="tagline">Trust Through Cryptographic Verification</p>
        </header>

        <!-- Sticky Jump Nav -->
        <nav class="jump-nav">
            <a href="#quick-reference">Quick Reference</a>
            <a href="#x509-structure">X.509 Structure</a>
            <a href="#certificate-authorities">CAs &amp; Trust</a>
            <a href="#certificate-lifecycle">Lifecycle</a>
            <a href="#tls-handshake">TLS/SSL Handshake</a>
            <a href="#mutual-tls">mTLS</a>
            <a href="#cert-formats">Formats</a>
            <a href="#lets-encrypt">Let's Encrypt</a>
            <a href="#enterprise-pki">Enterprise PKI</a>
            <a href="#key-management">Key Management</a>
            <a href="#advanced-topics">Advanced</a>
            <a href="#troubleshooting">Troubleshooting</a>
        </nav>

        <!-- ============================================================
             SECTION 01 — QUICK REFERENCE
             ============================================================ -->
        <section id="quick-reference" class="section">
            <div class="section-header">
                <div class="section-number">Section 01</div>
                <h2 class="section-title">Quick Reference</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">The most-used OpenSSL commands at a glance. Copy, paste, and adapt.</p>
            </div>

            <div class="section-content">

                <!-- Key Generation -->
                <div class="subsection">
                    <h3 class="subsection-title">Key Generation</h3>
                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Generate RSA Key (4096-bit)</div>
                            <pre><code>openssl genrsa -out private.key 4096</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Generate EC Key (P-256)</div>
                            <pre><code>openssl ecparam -genkey -name prime256v1 \
  -out ec.key</code></pre>
                        </div>
                    </div>
                </div>

                <!-- CSR & Signing -->
                <div class="subsection">
                    <h3 class="subsection-title">CSR &amp; Signing</h3>
                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Create Certificate Signing Request</div>
                            <pre><code>openssl req -new -key private.key \
  -out request.csr</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Self-Signed Certificate (1 Year)</div>
                            <pre><code>openssl req -x509 -newkey rsa:4096 \
  -nodes -keyout key.pem \
  -out cert.pem -days 365</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Inspection -->
                <div class="subsection">
                    <h3 class="subsection-title">Certificate Inspection</h3>
                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">View Certificate Details</div>
                            <pre><code>openssl x509 -in cert.pem -text -noout</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Check Expiration Date</div>
                            <pre><code>openssl x509 -enddate -noout -in cert.pem</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Verify Certificate Chain</div>
                            <pre><code>openssl verify -CAfile ca.crt \
  -untrusted intermediate.crt server.crt</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Test Remote Connection</div>
                            <pre><code>openssl s_client -connect example.com:443 \
  -showcerts</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Conversion -->
                <div class="subsection">
                    <h3 class="subsection-title">Format Conversion</h3>
                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">PEM to DER</div>
                            <pre><code>openssl x509 -outform der \
  -in cert.pem -out cert.der</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">PEM to PKCS#12 (.pfx)</div>
                            <pre><code>openssl pkcs12 -export -out cert.pfx \
  -inkey key.pem -in cert.pem</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Match Private Key to Certificate</div>
                            <pre><code>openssl x509 -noout -modulus -in cert.pem \
  | openssl md5
openssl rsa -noout -modulus -in key.pem \
  | openssl md5</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Extract from PKCS#12 (.pfx)</div>
                            <pre><code>openssl pkcs12 -in cert.pfx \
  -out cert.pem -nodes</code></pre>
                        </div>
                    </div>
                </div>

                <div class="alert alert-tip">
                    <div class="alert-title">Tip: Verify Before Deploying</div>
                    <div class="alert-body">
                        Always run <code>openssl verify</code> on your full chain before deploying to production. A missing intermediate certificate is the most common cause of TLS errors in browsers.
                    </div>
                </div>

            </div>
        </section>

        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <!-- ============================================================
             SECTION 02 — X.509 CERTIFICATE STRUCTURE
             ============================================================ -->
        <section id="x509-structure" class="section">
            <div class="section-header">
                <div class="section-number">Section 02</div>
                <h2 class="section-title">X.509 Certificate Structure</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">Anatomy of the digital document that binds a public key to an identity.</p>
            </div>

            <div class="section-content">

                <!-- Core Fields -->
                <div class="subsection">
                    <h3 class="subsection-title">Certificate Fields</h3>
                    <p class="subsection-intro">
                        An X.509 certificate is an ASN.1 structure defined by RFC 5280. Every certificate contains these core fields, encoded using DER (Distinguished Encoding Rules) and typically wrapped in PEM (Base64) for transport.
                    </p>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Field</th>
                                    <th>Description</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Version</strong></td>
                                    <td>X.509 version number (v1, v2, or v3)</td>
                                    <td><code>Version: 3 (0x2)</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Serial Number</strong></td>
                                    <td>Unique identifier assigned by the CA; must be unique per CA</td>
                                    <td><code>04:e3:a5:b8:...</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Signature Algorithm</strong></td>
                                    <td>Algorithm the CA used to sign this certificate</td>
                                    <td><code>sha256WithRSAEncryption</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Issuer</strong></td>
                                    <td>Distinguished Name (DN) of the CA that signed the certificate</td>
                                    <td><code>CN=Let's Encrypt Authority X3, O=Let's Encrypt</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Validity</strong></td>
                                    <td>Not Before and Not After timestamps (UTC)</td>
                                    <td><code>Not Before: Jan 1 00:00:00 2025 GMT</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Subject</strong></td>
                                    <td>Distinguished Name of the entity this certificate identifies</td>
                                    <td><code>CN=www.example.com, O=Example Inc.</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Subject Public Key Info</strong></td>
                                    <td>Algorithm and the actual public key bytes</td>
                                    <td><code>RSA (4096 bit)</code> or <code>EC (prime256v1)</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Extensions</strong></td>
                                    <td>v3 extension fields (see below)</td>
                                    <td>Basic Constraints, Key Usage, SAN, etc.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- v1 vs v3 -->
                <div class="subsection">
                    <h3 class="subsection-title">Version 1 vs. Version 3</h3>
                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-ruby">X.509 v1 (1988)</div>
                            <ul>
                                <li>Basic fields only: version, serial, issuer, validity, subject, public key</li>
                                <li>No extensions support</li>
                                <li>Cannot distinguish CA from end-entity</li>
                                <li>No Subject Alternative Names</li>
                                <li>Obsolete; do not use for new deployments</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-emerald">X.509 v3 (1996+)</div>
                            <ul>
                                <li>All v1 fields plus arbitrary extensions</li>
                                <li>Critical vs. non-critical extension marking</li>
                                <li>Basic Constraints distinguish CA from leaf</li>
                                <li>SAN allows multiple DNS names and IPs</li>
                                <li>Industry standard; required for TLS</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Critical Extensions -->
                <div class="subsection">
                    <h3 class="subsection-title">Critical v3 Extensions</h3>
                    <p class="subsection-intro">
                        Extensions marked as <strong>critical</strong> must be understood by the verifying application; if an extension is critical and unrecognized, the certificate must be rejected. Non-critical extensions can be safely ignored.
                    </p>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Extension</th>
                                    <th>OID</th>
                                    <th>Purpose</th>
                                    <th>Typically Critical?</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Basic Constraints</strong></td>
                                    <td><code>2.5.29.19</code></td>
                                    <td>Identifies whether subject is a CA; limits chain depth via <code>pathLenConstraint</code></td>
                                    <td><span class="badge badge-ruby"><span>Yes</span></span></td>
                                </tr>
                                <tr>
                                    <td><strong>Key Usage</strong></td>
                                    <td><code>2.5.29.15</code></td>
                                    <td>Restricts cryptographic operations (signing, encryption, etc.)</td>
                                    <td><span class="badge badge-ruby"><span>Yes</span></span></td>
                                </tr>
                                <tr>
                                    <td><strong>Extended Key Usage</strong></td>
                                    <td><code>2.5.29.37</code></td>
                                    <td>Purpose-specific: serverAuth, clientAuth, codeSigning, etc.</td>
                                    <td><span class="badge badge-sapphire"><span>Varies</span></span></td>
                                </tr>
                                <tr>
                                    <td><strong>Subject Alternative Name</strong></td>
                                    <td><code>2.5.29.17</code></td>
                                    <td>Additional identities: DNS names, IPs, email, URIs</td>
                                    <td><span class="badge badge-sapphire"><span>Varies</span></span></td>
                                </tr>
                                <tr>
                                    <td><strong>Authority Key Identifier</strong></td>
                                    <td><code>2.5.29.35</code></td>
                                    <td>Identifies the CA key that signed this cert (for chain building)</td>
                                    <td><span class="badge badge-emerald"><span>No</span></span></td>
                                </tr>
                                <tr>
                                    <td><strong>Subject Key Identifier</strong></td>
                                    <td><code>2.5.29.14</code></td>
                                    <td>Hash of this cert's public key (referenced by AKI in child certs)</td>
                                    <td><span class="badge badge-emerald"><span>No</span></span></td>
                                </tr>
                                <tr>
                                    <td><strong>CRL Distribution Points</strong></td>
                                    <td><code>2.5.29.31</code></td>
                                    <td>URLs where revocation lists can be fetched</td>
                                    <td><span class="badge badge-emerald"><span>No</span></span></td>
                                </tr>
                                <tr>
                                    <td><strong>Authority Information Access</strong></td>
                                    <td><code>1.3.6.1.5.5.7.1.1</code></td>
                                    <td>OCSP responder URL and CA Issuer cert download location</td>
                                    <td><span class="badge badge-emerald"><span>No</span></span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Key Usage Bits -->
                <div class="subsection">
                    <h3 class="subsection-title">Key Usage Bits</h3>
                    <p class="subsection-intro">
                        The Key Usage extension is a 9-bit field that restricts what cryptographic operations a key may perform. Setting the wrong bits is a common source of interoperability failures.
                    </p>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Bit</th>
                                    <th>Name</th>
                                    <th>Used By</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>0</td>
                                    <td><code>digitalSignature</code></td>
                                    <td>TLS servers, clients, code signing</td>
                                    <td>Authenticate the entity (ECDHE, DHE key exchange)</td>
                                </tr>
                                <tr>
                                    <td>1</td>
                                    <td><code>nonRepudiation</code></td>
                                    <td>Document signing</td>
                                    <td>Provide evidence that the signer cannot deny signing</td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td><code>keyEncipherment</code></td>
                                    <td>RSA key exchange in TLS</td>
                                    <td>Encrypt symmetric keys (RSA key transport)</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td><code>dataEncipherment</code></td>
                                    <td>Rare; specific applications</td>
                                    <td>Directly encrypt user data (not key material)</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td><code>keyAgreement</code></td>
                                    <td>DH/ECDH</td>
                                    <td>Key agreement protocols (Diffie-Hellman)</td>
                                </tr>
                                <tr>
                                    <td>5</td>
                                    <td><code>keyCertSign</code></td>
                                    <td>CA certificates only</td>
                                    <td>Sign other certificates (requires Basic Constraints CA:TRUE)</td>
                                </tr>
                                <tr>
                                    <td>6</td>
                                    <td><code>cRLSign</code></td>
                                    <td>CA certificates only</td>
                                    <td>Sign Certificate Revocation Lists</td>
                                </tr>
                                <tr>
                                    <td>7</td>
                                    <td><code>encipherOnly</code></td>
                                    <td>Combined with keyAgreement</td>
                                    <td>Public key for enciphering data during key agreement only</td>
                                </tr>
                                <tr>
                                    <td>8</td>
                                    <td><code>decipherOnly</code></td>
                                    <td>Combined with keyAgreement</td>
                                    <td>Public key for deciphering data during key agreement only</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-info">
                        <div class="alert-title">Common Key Usage Profiles</div>
                        <div class="alert-body">
                            <strong>TLS Server (RSA):</strong> <code>digitalSignature</code>, <code>keyEncipherment</code><br>
                            <strong>TLS Server (ECDSA):</strong> <code>digitalSignature</code><br>
                            <strong>CA Certificate:</strong> <code>keyCertSign</code>, <code>cRLSign</code><br>
                            <strong>Code Signing:</strong> <code>digitalSignature</code>
                        </div>
                    </div>
                </div>

                <!-- Extended Key Usage OIDs -->
                <div class="subsection">
                    <h3 class="subsection-title">Extended Key Usage OIDs</h3>
                    <p class="subsection-intro">
                        While Key Usage restricts <em>cryptographic</em> operations, Extended Key Usage (EKU) restricts the <em>application-level</em> purpose. OIDs are dot-delimited numbers from the ITU/ISO object identifier tree.
                    </p>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Purpose</th>
                                    <th>OID</th>
                                    <th>Short Name</th>
                                    <th>Use Case</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>TLS Server Authentication</strong></td>
                                    <td><code>1.3.6.1.5.5.7.3.1</code></td>
                                    <td><code>serverAuth</code></td>
                                    <td>HTTPS servers, any TLS server endpoint</td>
                                </tr>
                                <tr>
                                    <td><strong>TLS Client Authentication</strong></td>
                                    <td><code>1.3.6.1.5.5.7.3.2</code></td>
                                    <td><code>clientAuth</code></td>
                                    <td>Mutual TLS (mTLS), VPN client certs</td>
                                </tr>
                                <tr>
                                    <td><strong>Code Signing</strong></td>
                                    <td><code>1.3.6.1.5.5.7.3.3</code></td>
                                    <td><code>codeSigning</code></td>
                                    <td>Signing executables, scripts, packages</td>
                                </tr>
                                <tr>
                                    <td><strong>Email Protection</strong></td>
                                    <td><code>1.3.6.1.5.5.7.3.4</code></td>
                                    <td><code>emailProtection</code></td>
                                    <td>S/MIME email signing and encryption</td>
                                </tr>
                                <tr>
                                    <td><strong>OCSP Signing</strong></td>
                                    <td><code>1.3.6.1.5.5.7.3.9</code></td>
                                    <td><code>OCSPSigning</code></td>
                                    <td>Signing OCSP responses on behalf of a CA</td>
                                </tr>
                                <tr>
                                    <td><strong>Time Stamping</strong></td>
                                    <td><code>1.3.6.1.5.5.7.3.8</code></td>
                                    <td><code>timeStamping</code></td>
                                    <td>Trusted timestamp authority responses</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-note">
                        <div class="alert-title">OID Format Explained</div>
                        <div class="alert-body">
                            OIDs follow a hierarchical tree. For example, <code>2.5.29.17</code> (SAN) breaks down as:
                            <code>2</code> (joint-iso-itu-t) &rarr; <code>5</code> (ds) &rarr; <code>29</code> (certificateExtension) &rarr; <code>17</code> (subjectAltName). The <code>1.3.6.1.5.5.7</code> prefix is the PKIX arc under which most internet PKI OIDs live.
                        </div>
                    </div>
                </div>

                <!-- Decoded Certificate Example -->
                <div class="subsection">
                    <h3 class="subsection-title">Decoded Certificate Example</h3>
                    <p class="subsection-intro">
                        Output from <code>openssl x509 -in server.crt -text -noout</code> showing a typical TLS server certificate:
                    </p>

                    <pre><code><span class="code-keyword">Certificate:</span>
    Data:
        <span class="code-flag">Version:</span> 3 (0x2)
        <span class="code-flag">Serial Number:</span>
            04:e3:a5:b8:c7:2d:9f:01:aa:bb:cc:dd:ee:ff:00:11
        <span class="code-flag">Signature Algorithm:</span> sha256WithRSAEncryption
        <span class="code-flag">Issuer:</span> C=US, O=Let's Encrypt, CN=R3
        <span class="code-flag">Validity</span>
            Not Before: Jan 15 00:00:00 2025 GMT
            Not After : Apr 15 23:59:59 2025 GMT
        <span class="code-flag">Subject:</span> CN=www.example.com
        <span class="code-flag">Subject Public Key Info:</span>
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        <span class="code-keyword">X509v3 extensions:</span>
            X509v3 Key Usage: <span class="code-value">critical</span>
                Digital Signature
            X509v3 Extended Key Usage:
                TLS Web Server Authentication, TLS Web Client Authentication
            X509v3 Basic Constraints: <span class="code-value">critical</span>
                CA:<span class="code-string">FALSE</span>
            X509v3 Subject Key Identifier:
                A1:B2:C3:D4:E5:F6:01:02:03:04:05:06:07:08:09:10
            X509v3 Authority Key Identifier:
                14:2E:B3:17:B7:58:56:CB:AE:50:09:40:E6:1F:AF:9D
            X509v3 Subject Alternative Name:
                DNS:www.example.com, DNS:example.com
            Authority Information Access:
                OCSP - URI:<span class="code-path">http://r3.o.lencr.org</span>
                CA Issuers - URI:<span class="code-path">http://r3.i.lencr.org/</span>
            X509v3 CRL Distribution Points:
                Full Name:
                    URI:<span class="code-path">http://r3.c.lencr.org/</span>
            X509v3 Certificate Policies:
                Policy: 2.23.140.1.2.1</code></pre>
                </div>

            </div>
        </section>

        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <!-- ============================================================
             SECTION 03 — CERTIFICATE AUTHORITIES & TRUST
             ============================================================ -->
        <section id="certificate-authorities" class="section">
            <div class="section-header">
                <div class="section-number">Section 03</div>
                <h2 class="section-title">Certificate Authorities &amp; Trust</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">How hierarchical trust is established, maintained, and verified across the internet.</p>
            </div>

            <div class="section-content">

                <!-- CA Hierarchy Diagram -->
                <div class="subsection">
                    <h3 class="subsection-title">CA Hierarchy</h3>
                    <p class="subsection-intro">
                        Public Key Infrastructure forms a tree of trust. The root CA sits at the apex, delegating signing authority through one or more intermediate CAs down to end-entity (leaf) certificates.
                    </p>

                    <div class="glass-panel">
                        <div class="flow-diagram flow-vertical">
                            <div class="flow-box flow-box-ruby">
                                <div class="flow-label">Root CA</div>
                                <div class="flow-sub">Self-signed, offline, 20-30 year validity</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber">
                                <div class="flow-label">Intermediate CA</div>
                                <div class="flow-sub">Signed by root, 5-10 year validity</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-sapphire">
                                <div class="flow-label">Issuing CA</div>
                                <div class="flow-sub">Signed by intermediate, 3-5 year validity</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald">
                                <div class="flow-label">End-Entity Certificate</div>
                                <div class="flow-sub">Your server/client cert, 90 days &ndash; 1 year</div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-warning">
                        <div class="alert-title">Why Intermediate CAs Exist</div>
                        <div class="alert-body">
                            Root CA private keys are kept offline in air-gapped HSMs. If a root key were compromised, every certificate in the hierarchy would be invalid. Intermediate CAs allow day-to-day issuance while the root remains protected. If an intermediate is compromised, only that branch of the tree is revoked.
                        </div>
                    </div>
                </div>

                <!-- CA Roles -->
                <div class="subsection">
                    <h3 class="subsection-title">CA Roles Explained</h3>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Role</th>
                                    <th>Key Storage</th>
                                    <th>Typical Validity</th>
                                    <th>Responsibilities</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Root CA</strong></td>
                                    <td>Offline HSM, air-gapped</td>
                                    <td>20&ndash;30 years</td>
                                    <td>Sign intermediate CA certs, CRL signing, policy definition</td>
                                </tr>
                                <tr>
                                    <td><strong>Intermediate CA</strong></td>
                                    <td>Online or semi-offline HSM</td>
                                    <td>5&ndash;10 years</td>
                                    <td>Sign issuing CA certs, policy enforcement, scope limitation</td>
                                </tr>
                                <tr>
                                    <td><strong>Issuing CA</strong></td>
                                    <td>Online HSM</td>
                                    <td>3&ndash;5 years</td>
                                    <td>Sign end-entity certs, OCSP responder, CRL publication</td>
                                </tr>
                                <tr>
                                    <td><strong>Registration Authority</strong></td>
                                    <td>No signing keys</td>
                                    <td>N/A</td>
                                    <td>Identity verification, CSR validation, policy checking</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Cross-Signing -->
                <div class="subsection">
                    <h3 class="subsection-title">Cross-Signing</h3>
                    <p class="subsection-intro">
                        Cross-signing allows a new CA to be trusted by existing clients before its own root is widely distributed. A well-established CA signs the new CA's public key, creating an alternative trust path.
                    </p>

                    <div class="glass-panel">
                        <div class="flow-diagram">
                            <div class="flow-box flow-box-ruby">
                                <div class="flow-label">Old Root CA</div>
                                <div class="flow-sub">Widely trusted</div>
                            </div>
                            <div class="flow-arrow">&rarr;</div>
                            <div class="flow-box flow-box-amethyst">
                                <div class="flow-label">Cross-Sign</div>
                                <div class="flow-sub">Signs new CA's key</div>
                            </div>
                            <div class="flow-arrow">&rarr;</div>
                            <div class="flow-box flow-box-amber">
                                <div class="flow-label">New Root CA</div>
                                <div class="flow-sub">Same key, two certs</div>
                            </div>
                        </div>
                    </div>

                    <p>
                        <strong>Example:</strong> Let's Encrypt's <code>ISRG Root X1</code> was cross-signed by IdenTrust's <code>DST Root CA X3</code>, allowing Android devices and older browsers to trust Let's Encrypt certificates before ISRG Root X1 was added to their trust stores.
                    </p>

                    <div class="alert alert-info">
                        <div class="alert-title">Cross-Signing Is Not Cross-Certification</div>
                        <div class="alert-body">
                            Cross-signing creates a second certificate for the <em>same</em> public key, signed by a different CA. Cross-certification (bridge CAs) is a more complex mutual trust arrangement between two independent PKI hierarchies, common in government and military networks.
                        </div>
                    </div>
                </div>

                <!-- Trust Stores -->
                <div class="subsection">
                    <h3 class="subsection-title">Trust Store Overview</h3>
                    <p class="subsection-intro">
                        Every operating system and application maintains a curated list of trusted root CA certificates. This is the foundation of all public PKI trust decisions.
                    </p>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Platform</th>
                                    <th>Trust Store Location</th>
                                    <th>Management</th>
                                    <th>Approx. Root CAs</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Windows</strong></td>
                                    <td><code>certlm.msc</code> / Certificate Manager</td>
                                    <td>Microsoft Trusted Root Program, auto-updated via Windows Update</td>
                                    <td>~400</td>
                                </tr>
                                <tr>
                                    <td><strong>macOS / iOS</strong></td>
                                    <td>Keychain Access / System Roots</td>
                                    <td>Apple Root Certificate Program, updated with OS releases</td>
                                    <td>~175</td>
                                </tr>
                                <tr>
                                    <td><strong>Linux (Debian/Ubuntu)</strong></td>
                                    <td><code>/etc/ssl/certs/</code> via <code>ca-certificates</code></td>
                                    <td>Mozilla NSS trust bundle, managed by distro package</td>
                                    <td>~140</td>
                                </tr>
                                <tr>
                                    <td><strong>Linux (RHEL/Fedora)</strong></td>
                                    <td><code>/etc/pki/tls/certs/</code></td>
                                    <td>Mozilla NSS via <code>ca-certificates</code> package</td>
                                    <td>~140</td>
                                </tr>
                                <tr>
                                    <td><strong>Firefox</strong></td>
                                    <td>Built-in NSS trust store</td>
                                    <td>Mozilla Root Store Policy (independent of OS)</td>
                                    <td>~155</td>
                                </tr>
                                <tr>
                                    <td><strong>Chrome</strong></td>
                                    <td>Chrome Root Store (since 2022)</td>
                                    <td>Google Chrome Root Program (was OS-dependent)</td>
                                    <td>~140</td>
                                </tr>
                                <tr>
                                    <td><strong>Java / JVM</strong></td>
                                    <td><code>$JAVA_HOME/lib/security/cacerts</code></td>
                                    <td>Oracle/OpenJDK manage; use <code>keytool</code> to modify</td>
                                    <td>~100</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Chain Building & Validation -->
                <div class="subsection">
                    <h3 class="subsection-title">Chain Building &amp; Validation (RFC 5280)</h3>
                    <p class="subsection-intro">
                        When a client receives a server certificate, it must build a chain from the leaf up to a trusted root and validate every link. Here are the validation steps in order:
                    </p>

                    <div class="glass-panel">
                        <ol style="padding-left: var(--space-6); color: var(--text-primary);">
                            <li style="margin-bottom: var(--space-3);"><strong style="color: var(--amber);">Signature Verification</strong> &mdash; Verify each certificate's signature using the issuer's public key. Start from the leaf, walk up to the root.</li>
                            <li style="margin-bottom: var(--space-3);"><strong style="color: var(--amber);">Validity Period</strong> &mdash; Check that the current time falls within <code>notBefore</code> and <code>notAfter</code> for every certificate in the chain.</li>
                            <li style="margin-bottom: var(--space-3);"><strong style="color: var(--amber);">Revocation Status</strong> &mdash; Query OCSP responder or download CRL for each certificate. OCSP stapling lets the server provide a pre-fetched response.</li>
                            <li style="margin-bottom: var(--space-3);"><strong style="color: var(--amber);">Name Matching</strong> &mdash; Verify the requested hostname matches either the Subject CN or a SAN entry (SAN takes precedence per RFC 6125).</li>
                            <li style="margin-bottom: var(--space-3);"><strong style="color: var(--amber);">Basic Constraints</strong> &mdash; Ensure intermediate certs have <code>CA:TRUE</code> and the leaf has <code>CA:FALSE</code>. Respect <code>pathLenConstraint</code>.</li>
                            <li style="margin-bottom: var(--space-3);"><strong style="color: var(--amber);">Key Usage</strong> &mdash; Confirm the leaf cert's Key Usage bits permit the operation (e.g., <code>digitalSignature</code> for ECDHE).</li>
                            <li style="margin-bottom: var(--space-3);"><strong style="color: var(--amber);">Policy Constraints</strong> &mdash; If Certificate Policies or Policy Constraints extensions are present, verify they are satisfied.</li>
                            <li style="margin-bottom: var(--space-3);"><strong style="color: var(--amber);">Trust Anchor</strong> &mdash; The chain must terminate at a certificate present in the local trust store. If no anchor is found, the connection is rejected.</li>
                        </ol>
                    </div>
                </div>

                <!-- Self-Signed vs CA-Signed -->
                <div class="subsection">
                    <h3 class="subsection-title">Self-Signed vs. CA-Signed</h3>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-amber">Self-Signed Certificates</div>
                            <ul>
                                <li><strong>Issuer = Subject</strong>; signed by its own private key</li>
                                <li>Free and instant to generate</li>
                                <li>Not trusted by browsers/OS without manual import</li>
                                <li>No revocation infrastructure</li>
                                <li>Appropriate for: development, internal testing, air-gapped systems</li>
                                <li>Trust is established out-of-band (manual distribution)</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-emerald">CA-Signed Certificates</div>
                            <ul>
                                <li><strong>Issuer =/= Subject</strong>; signed by a trusted CA's key</li>
                                <li>Free (Let's Encrypt) or paid (DigiCert, Sectigo, etc.)</li>
                                <li>Automatically trusted by all major browsers and OS</li>
                                <li>Full revocation support (OCSP, CRL)</li>
                                <li>Appropriate for: production, public-facing, compliance requirements</li>
                                <li>Trust via pre-installed root certificates in trust stores</li>
                            </ul>
                        </div>
                    </div>

                    <div class="alert alert-warning">
                        <div class="alert-title">Never Use Self-Signed in Production</div>
                        <div class="alert-body">
                            Self-signed certificates in production force users to bypass security warnings, training them to ignore TLS errors. This undermines the entire purpose of PKI. Use Let's Encrypt for free, automated, CA-signed certificates even for internal services.
                        </div>
                    </div>
                </div>

                <!-- Adding Custom CA to Trust Stores -->
                <div class="subsection">
                    <h3 class="subsection-title">Adding a Custom CA to Trust Stores</h3>
                    <p class="subsection-intro">
                        For internal/enterprise CAs, you must distribute the root certificate to all client machines. Here are the commands for each platform:
                    </p>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Debian / Ubuntu</div>
                            <pre><code><span class="code-comment"># Copy CA cert to the trusted directory</span>
sudo cp corp-ca.crt \
  /usr/local/share/ca-certificates/corp-ca.crt

<span class="code-comment"># Rebuild the trust store</span>
sudo update-ca-certificates</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">RHEL / Fedora / CentOS</div>
                            <pre><code><span class="code-comment"># Copy to anchors directory</span>
sudo cp corp-ca.crt \
  /etc/pki/ca-trust/source/anchors/corp-ca.crt

<span class="code-comment"># Update the consolidated bundle</span>
sudo update-ca-trust</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">macOS</div>
                            <pre><code><span class="code-comment"># Add to System keychain as trusted root</span>
sudo security add-trusted-cert \
  -d -r trustRoot \
  -k /Library/Keychains/System.keychain \
  corp-ca.crt</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Windows (PowerShell)</div>
                            <pre><code><span class="code-comment"># Import to Trusted Root store (machine-wide)</span>
Import-Certificate `
  -FilePath .\corp-ca.crt `
  -CertStoreLocation Cert:\LocalMachine\Root</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Java (keytool)</div>
                            <pre><code><span class="code-comment"># Import to Java trust store (cacerts)</span>
keytool -import -trustcacerts \
  -alias corp-ca \
  -file corp-ca.crt \
  -keystore $JAVA_HOME/lib/security/cacerts \
  -storepass changeit</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Firefox (Manual / Policy)</div>
                            <pre><code><span class="code-comment"># Firefox ignores OS trust stores by default.</span>
<span class="code-comment"># Option 1: Import via Preferences > Certificates</span>
<span class="code-comment"># Option 2: Deploy policies.json:</span>
{
  "policies": {
    "Certificates": {
      "ImportEnterpriseRoots": true
    }
  }
}</code></pre>
                        </div>
                    </div>

                    <div class="alert alert-tip">
                        <div class="alert-title">Enterprise Deployment</div>
                        <div class="alert-body">
                            Use configuration management (Ansible, Puppet, Chef) or Group Policy (Windows) to automate CA distribution across your fleet. Never ask users to manually install certificates.
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <!-- ============================================================
             SECTION 04 — CERTIFICATE LIFECYCLE
             ============================================================ -->
        <section id="certificate-lifecycle" class="section">
            <div class="section-header">
                <div class="section-number">Section 04</div>
                <h2 class="section-title">Certificate Lifecycle</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">From request to revocation: the full journey of a digital certificate.</p>
            </div>

            <div class="section-content">

                <!-- CSR Generation -->
                <div class="subsection">
                    <h3 class="subsection-title">CSR Generation Process</h3>
                    <p class="subsection-intro">
                        A Certificate Signing Request (CSR) is a signed data structure sent to a CA containing your <strong>public key</strong>, <strong>identifying information</strong> (subject DN, SANs), and a <strong>proof-of-possession signature</strong> made with the corresponding private key. The CA verifies the signature to confirm you hold the private key, then issues a certificate binding that key to your identity.
                    </p>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Generate CSR (Interactive)</div>
                            <pre><code><span class="code-comment"># Generates CSR, prompts for subject fields</span>
openssl req <span class="code-flag">-new</span> \
  <span class="code-flag">-key</span> <span class="code-path">private.key</span> \
  <span class="code-flag">-out</span> <span class="code-path">request.csr</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Generate CSR with SAN (One-Liner)</div>
                            <pre><code><span class="code-comment"># Non-interactive with Subject Alternative Names</span>
openssl req <span class="code-flag">-new</span> \
  <span class="code-flag">-key</span> <span class="code-path">private.key</span> \
  <span class="code-flag">-out</span> <span class="code-path">request.csr</span> \
  <span class="code-flag">-subj</span> <span class="code-string">"/CN=example.com/O=Example Inc./C=US"</span> \
  <span class="code-flag">-addext</span> <span class="code-string">"subjectAltName=DNS:example.com,DNS:www.example.com,DNS:api.example.com"</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Generate Key + CSR Together</div>
                            <pre><code><span class="code-comment"># Create new key and CSR in one command</span>
openssl req <span class="code-flag">-new</span> <span class="code-flag">-newkey</span> rsa:4096 \
  <span class="code-flag">-nodes</span> \
  <span class="code-flag">-keyout</span> <span class="code-path">private.key</span> \
  <span class="code-flag">-out</span> <span class="code-path">request.csr</span> \
  <span class="code-flag">-subj</span> <span class="code-string">"/CN=example.com"</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Verify CSR Contents</div>
                            <pre><code><span class="code-comment"># Inspect CSR before submitting to CA</span>
openssl req <span class="code-flag">-in</span> <span class="code-path">request.csr</span> \
  <span class="code-flag">-text</span> <span class="code-flag">-noout</span> <span class="code-flag">-verify</span>

<span class="code-comment"># Output includes:</span>
<span class="code-comment">#   verify OK</span>
<span class="code-comment">#   Subject: CN = example.com</span>
<span class="code-comment">#   Public Key Algorithm: rsaEncryption</span>
<span class="code-comment">#   Requested Extensions:</span>
<span class="code-comment">#     X509v3 Subject Alternative Name:</span>
<span class="code-comment">#       DNS:example.com, DNS:www.example.com</span></code></pre>
                        </div>
                    </div>

                    <div class="alert alert-tip">
                        <div class="alert-title">CSR Best Practices</div>
                        <div class="alert-body">
                            Always include SANs in your CSR. Since 2017, browsers ignore the Subject CN for hostname matching and rely exclusively on the Subject Alternative Name extension (per CA/Browser Forum Baseline Requirements). A CSR without SANs will produce a certificate that triggers browser warnings.
                        </div>
                    </div>
                </div>

                <!-- Validation Levels -->
                <div class="subsection">
                    <h3 class="subsection-title">Certificate Issuance &mdash; Validation Levels</h3>
                    <p class="subsection-intro">
                        Certificate Authorities offer three levels of identity validation before issuing a certificate. Each level provides increasing assurance about who controls the domain and organization behind it.
                    </p>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Aspect</th>
                                    <th><span class="badge badge-emerald"><span>DV</span></span> Domain Validated</th>
                                    <th><span class="badge badge-sapphire"><span>OV</span></span> Organization Validated</th>
                                    <th><span class="badge badge-ruby"><span>EV</span></span> Extended Validation</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>What Is Validated</strong></td>
                                    <td>Domain control only (DNS or HTTP challenge)</td>
                                    <td>Domain control + organization identity (business registration, address)</td>
                                    <td>Domain control + rigorous organization vetting (legal existence, operational existence, physical address, authority of requester)</td>
                                </tr>
                                <tr>
                                    <td><strong>Issuance Time</strong></td>
                                    <td>Minutes (automated)</td>
                                    <td>1&ndash;3 business days</td>
                                    <td>3&ndash;10 business days</td>
                                </tr>
                                <tr>
                                    <td><strong>Browser Indicator</strong></td>
                                    <td>Padlock icon only</td>
                                    <td>Padlock icon (organization info in cert details)</td>
                                    <td>Padlock icon (organization info in cert details; green bar removed by most browsers since 2019)</td>
                                </tr>
                                <tr>
                                    <td><strong>Use Cases</strong></td>
                                    <td>Blogs, personal sites, APIs, microservices, internal tools</td>
                                    <td>Business websites, SaaS applications, customer portals</td>
                                    <td>Banking, financial services, government, high-trust e-commerce</td>
                                </tr>
                                <tr>
                                    <td><strong>Typical Cost</strong></td>
                                    <td>Free (Let's Encrypt) to $50/year</td>
                                    <td>$50&ndash;$200/year</td>
                                    <td>$150&ndash;$500+/year</td>
                                </tr>
                                <tr>
                                    <td><strong>Certificate Policy OID</strong></td>
                                    <td><code>2.23.140.1.2.1</code></td>
                                    <td><code>2.23.140.1.2.2</code></td>
                                    <td><code>2.23.140.1.1</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-info">
                        <div class="alert-title">DV Is Sufficient for Most Use Cases</div>
                        <div class="alert-body">
                            DV certificates provide the same encryption strength as OV and EV. The difference is purely about identity assurance. With browser UI changes eliminating visible EV indicators, the practical benefit of EV has diminished. Focus your budget on automation and short-lived certificates rather than higher validation levels.
                        </div>
                    </div>
                </div>

                <!-- Renewal Strategies -->
                <div class="subsection">
                    <h3 class="subsection-title">Renewal Strategies</h3>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-ruby">Manual Renewal</div>
                            <ul>
                                <li>Generate new CSR or reuse existing key</li>
                                <li>Submit to CA, complete validation again</li>
                                <li>Download new certificate and chain</li>
                                <li>Install on server, restart services</li>
                                <li>Verify with <code>openssl s_client</code></li>
                                <li>Risk: human error, missed renewals, outages</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-emerald">Automated Renewal (ACME)</div>
                            <ul>
                                <li>ACME client (certbot, acme.sh) handles everything</li>
                                <li>Automatic challenge completion (HTTP-01, DNS-01)</li>
                                <li>Certificate fetched and installed automatically</li>
                                <li>Post-renewal hooks reload services</li>
                                <li>Runs via cron or systemd timer</li>
                                <li>Best practice: renew at 2/3 of certificate lifetime</li>
                            </ul>
                        </div>
                    </div>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Certbot Auto-Renewal (Cron)</div>
                            <pre><code><span class="code-comment"># Test renewal without making changes</span>
certbot renew <span class="code-flag">--dry-run</span>

<span class="code-comment"># Add to crontab (runs twice daily)</span>
0 0,12 * * * certbot renew <span class="code-flag">--quiet</span> \
  <span class="code-flag">--post-hook</span> <span class="code-string">"systemctl reload nginx"</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">acme.sh Auto-Renewal</div>
                            <pre><code><span class="code-comment"># Issue with auto-renewal configured</span>
acme.sh <span class="code-flag">--issue</span> \
  <span class="code-flag">-d</span> example.com \
  <span class="code-flag">-d</span> www.example.com \
  <span class="code-flag">--nginx</span> \
  <span class="code-flag">--reloadcmd</span> <span class="code-string">"systemctl reload nginx"</span>

<span class="code-comment"># acme.sh installs its own cron job</span>
<span class="code-comment"># automatically on first use</span></code></pre>
                        </div>
                    </div>

                    <div class="alert alert-warning">
                        <div class="alert-title">Certificate Lifetimes Are Shrinking</div>
                        <div class="alert-body">
                            The CA/Browser Forum voted in 2025 to progressively reduce maximum certificate lifetimes: <strong>200 days</strong> by March 2026, <strong>100 days</strong> by March 2027, and <strong>45 days</strong> by March 2029. Automated renewal is no longer optional &mdash; it is a requirement. Organizations still using manual renewal processes must adopt ACME or a Certificate Lifecycle Management (CLM) platform now.
                        </div>
                    </div>
                </div>

                <!-- Revocation Methods -->
                <div class="subsection">
                    <h3 class="subsection-title">Revocation Methods</h3>
                    <p class="subsection-intro">
                        When a certificate's private key is compromised, the certificate must be revoked before its natural expiration. Four mechanisms exist for communicating revocation status, each with significant trade-offs.
                    </p>

                    <!-- CRL -->
                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">CRL &mdash; Certificate Revocation Lists</h4>

                    <p>
                        A CRL is a signed list of revoked certificate serial numbers published by the CA at the URL specified in the certificate's <code>CRL Distribution Points</code> extension. Clients download the full list and cache it until the <code>nextUpdate</code> timestamp.
                    </p>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-emerald">Advantages</div>
                            <ul>
                                <li>Simple to implement and understand</li>
                                <li>Can be cached aggressively by clients</li>
                                <li>Works offline once downloaded</li>
                                <li>Delta CRLs reduce bandwidth (only changes since last full CRL)</li>
                                <li>No per-request load on CA infrastructure</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-ruby">Disadvantages</div>
                            <ul>
                                <li>Full CRLs can grow very large (megabytes)</li>
                                <li>Revocation info is stale until next CRL is published</li>
                                <li>Clients that fail to fetch CRL often soft-fail (accept anyway)</li>
                                <li>Not real-time; typical update interval is hours to days</li>
                                <li>Delta CRL support is inconsistent across clients</li>
                            </ul>
                        </div>
                    </div>

                    <!-- OCSP -->
                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">OCSP &mdash; Online Certificate Status Protocol</h4>

                    <p>
                        OCSP (RFC 6960) provides real-time revocation checking. The client sends the certificate's serial number to the CA's OCSP responder URL and receives a signed response: <code>good</code>, <code>revoked</code>, or <code>unknown</code>.
                    </p>

                    <div class="glass-panel">
                        <div class="flow-diagram">
                            <div class="flow-box flow-box-sapphire">
                                <div class="flow-label">Client</div>
                                <div class="flow-sub">Sends serial number</div>
                            </div>
                            <div class="flow-arrow">&rarr;</div>
                            <div class="flow-box flow-box-amethyst">
                                <div class="flow-label">OCSP Responder</div>
                                <div class="flow-sub">Checks CA database</div>
                            </div>
                            <div class="flow-arrow">&rarr;</div>
                            <div class="flow-box flow-box-emerald">
                                <div class="flow-label">Signed Response</div>
                                <div class="flow-sub">good / revoked / unknown</div>
                            </div>
                        </div>
                    </div>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-emerald">Advantages</div>
                            <ul>
                                <li>Near real-time revocation status</li>
                                <li>Small response size (~1-2 KB vs. megabyte CRLs)</li>
                                <li>Per-certificate queries (no bulk download)</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-ruby">Disadvantages</div>
                            <ul>
                                <li>Privacy concern: CA sees every site you visit</li>
                                <li>Adds latency to TLS connection (extra round trip)</li>
                                <li>Single point of failure (if responder is down, soft-fail)</li>
                                <li>CA must operate high-availability OCSP infrastructure</li>
                            </ul>
                        </div>
                    </div>

                    <!-- OCSP Stapling -->
                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">OCSP Stapling</h4>

                    <p>
                        With OCSP Stapling (RFC 6066, TLS Certificate Status Request), the <em>server</em> periodically fetches and caches the OCSP response, then includes ("staples") it in the TLS handshake. The client receives fresh revocation status without contacting the CA directly.
                    </p>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Nginx OCSP Stapling</div>
                            <pre><code>server {
    <span class="code-keyword">ssl_stapling</span> <span class="code-string">on</span>;
    <span class="code-keyword">ssl_stapling_verify</span> <span class="code-string">on</span>;

    <span class="code-comment"># CA chain for verifying OCSP response</span>
    <span class="code-keyword">ssl_trusted_certificate</span> <span class="code-path">/etc/ssl/chain.pem</span>;

    <span class="code-comment"># Resolver for OCSP responder lookup</span>
    <span class="code-keyword">resolver</span> 1.1.1.1 8.8.8.8 <span class="code-flag">valid=300s</span>;
    <span class="code-keyword">resolver_timeout</span> 5s;
}</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Apache OCSP Stapling</div>
                            <pre><code><span class="code-keyword">SSLUseStapling</span> On
<span class="code-keyword">SSLStaplingCache</span> \
  <span class="code-string">"shmcb:logs/ssl_stapling(32768)"</span>
<span class="code-keyword">SSLStaplingResponderTimeout</span> 5
<span class="code-keyword">SSLStaplingReturnResponderErrors</span> Off

<span class="code-comment"># Optional: force staple even if</span>
<span class="code-comment"># responder is slow</span>
<span class="code-keyword">SSLStaplingFakeTryLater</span> Off</code></pre>
                        </div>
                    </div>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Verify OCSP Stapling</div>
                            <pre><code><span class="code-comment"># Check if server is stapling OCSP response</span>
openssl s_client <span class="code-flag">-connect</span> example.com:443 \
  <span class="code-flag">-status</span> <span class="code-flag">-tlsextdebug</span> 2>&1 \
  | grep <span class="code-string">"OCSP Response Status"</span>

<span class="code-comment"># Expected: OCSP Response Status: successful (0x0)</span>
<span class="code-comment"># If missing: OCSP response: no response sent</span></code></pre>
                        </div>
                    </div>

                    <!-- OCSP Must-Staple -->
                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">OCSP Must-Staple (Deprecated)</h4>

                    <p>
                        The OCSP Must-Staple extension (RFC 7633, OID <code>1.3.6.1.5.5.7.1.24</code>) was designed to solve the soft-fail problem by requiring the server to include a valid OCSP staple. If the staple is missing, the client must hard-fail and reject the connection.
                    </p>

                    <div class="alert alert-warning">
                        <div class="alert-title">Must-Staple Is Being Abandoned</div>
                        <div class="alert-body">
                            Let's Encrypt stopped supporting OCSP Must-Staple in new certificates as part of their broader OCSP deprecation. The extension created more outages than it prevented: servers with misconfigured stapling would become completely inaccessible rather than falling back gracefully. Most CAs now discourage its use.
                        </div>
                    </div>

                    <!-- Industry Shift Alert -->
                    <div class="alert alert-info">
                        <div class="alert-title">Industry Shift: OCSP Is Fading, CRLs Are Returning</div>
                        <div class="alert-body">
                            Let's Encrypt announced in November 2024 that it would <strong>end OCSP support</strong> entirely, relying instead on short-lived certificates and CRLs. Their reasoning: OCSP is a privacy leak, operationally expensive, and soft-fail behavior means it rarely prevents use of revoked certificates anyway. The industry is converging on a combination of <strong>short certificate lifetimes</strong> (reducing the revocation window) and <strong>CRLs</strong> (via CRLite and similar compressed bloom-filter approaches built into browsers). Mozilla Firefox already ships CRLite, which compresses the entire web PKI revocation dataset into ~1 MB updated every few hours.
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <!-- ============================================================
             SECTION 05 — TLS/SSL HANDSHAKE
             ============================================================ -->
        <section id="tls-handshake" class="section">
            <div class="section-header">
                <div class="section-number">Section 05</div>
                <h2 class="section-title">TLS/SSL Handshake</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">How client and server negotiate a secure channel, step by step.</p>
            </div>

            <div class="section-content">

                <!-- TLS 1.2 Full Handshake -->
                <div class="subsection">
                    <h3 class="subsection-title">TLS 1.2 Full Handshake</h3>
                    <p class="subsection-intro">
                        The TLS 1.2 handshake requires two round trips (2-RTT) before application data can flow. Each message serves a specific purpose in negotiating algorithms, authenticating the server, and establishing shared secrets.
                    </p>

                    <div class="glass-panel">
                        <div class="flow-diagram flow-vertical">
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">1. ClientHello</div>
                                <div class="flow-sub">Client sends: supported TLS versions, cipher suites, random bytes, SNI</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">2. ServerHello</div>
                                <div class="flow-sub">Server selects: TLS version, cipher suite, sends random bytes</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">3. Certificate</div>
                                <div class="flow-sub">Server sends certificate chain (leaf + intermediates)</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">4. ServerKeyExchange</div>
                                <div class="flow-sub">Server's DH/ECDH parameters + signature (for PFS cipher suites)</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amethyst" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">5. CertificateRequest (Optional)</div>
                                <div class="flow-sub">Server requests client certificate (mTLS only)</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">6. ServerHelloDone</div>
                                <div class="flow-sub">Server signals end of its hello messages</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">7. ClientKeyExchange</div>
                                <div class="flow-sub">Client's DH/ECDH public value or RSA-encrypted pre-master secret</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">8. ChangeCipherSpec + Finished</div>
                                <div class="flow-sub">Client switches to encrypted mode, sends verification hash</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">9. ChangeCipherSpec + Finished</div>
                                <div class="flow-sub">Server switches to encrypted mode, sends verification hash</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">Application Data</div>
                                <div class="flow-sub">Encrypted communication begins (2-RTT total)</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TLS 1.3 Simplified Handshake -->
                <div class="subsection">
                    <h3 class="subsection-title">TLS 1.3 Simplified Handshake</h3>
                    <p class="subsection-intro">
                        TLS 1.3 (RFC 8446) dramatically simplifies the handshake to a single round trip (1-RTT) and supports zero round-trip resumption (0-RTT) for repeat connections. It removes legacy features, mandates PFS, and encrypts most handshake messages.
                    </p>

                    <div class="glass-panel">
                        <div class="flow-diagram flow-vertical">
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">1. ClientHello + Key Share</div>
                                <div class="flow-sub">Client sends: supported groups, key shares, cipher suites (all in one message)</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">2. ServerHello + Key Share</div>
                                <div class="flow-sub">Server selects group, sends key share; handshake now encrypted</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">3. Encrypted Extensions + Certificate + Finished</div>
                                <div class="flow-sub">Certificate, cert verify, and finished all encrypted in one flight</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">4. Client Finished</div>
                                <div class="flow-sub">Client verifies server, sends its own finished message</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">Application Data</div>
                                <div class="flow-sub">Encrypted communication begins (1-RTT total)</div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-note">
                        <div class="alert-title">0-RTT Early Data (TLS 1.3)</div>
                        <div class="alert-body">
                            Clients that have previously connected to a server can send encrypted application data in the <em>first</em> message using a pre-shared key (PSK) from the prior session. This is called 0-RTT or "early data." <strong>Security trade-off:</strong> 0-RTT data is not protected against replay attacks. An attacker who captures the ClientHello can resend it, potentially replaying the application request. Servers should only accept 0-RTT data for idempotent operations (e.g., GET requests) and must implement anti-replay mechanisms.
                        </div>
                    </div>

                    <!-- TLS 1.2 vs 1.3 Comparison -->
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Feature</th>
                                    <th>TLS 1.2</th>
                                    <th>TLS 1.3</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Round Trips</strong></td>
                                    <td>2-RTT (full), 1-RTT (session resumption)</td>
                                    <td>1-RTT (full), 0-RTT (resumption with PSK)</td>
                                </tr>
                                <tr>
                                    <td><strong>Cipher Suites</strong></td>
                                    <td>~37 supported suites (many weak)</td>
                                    <td>5 AEAD-only suites (all strong)</td>
                                </tr>
                                <tr>
                                    <td><strong>Perfect Forward Secrecy</strong></td>
                                    <td>Optional (depends on cipher suite)</td>
                                    <td>Mandatory (ECDHE/DHE only)</td>
                                </tr>
                                <tr>
                                    <td><strong>Key Exchange</strong></td>
                                    <td>RSA, DHE, ECDHE</td>
                                    <td>ECDHE, DHE only (RSA key transport removed)</td>
                                </tr>
                                <tr>
                                    <td><strong>Handshake Encryption</strong></td>
                                    <td>Certificates sent in plaintext</td>
                                    <td>Certificates encrypted after ServerHello</td>
                                </tr>
                                <tr>
                                    <td><strong>Removed Features</strong></td>
                                    <td>&mdash;</td>
                                    <td>RSA key exchange, RC4, DES, 3DES, MD5, SHA-1, compression, renegotiation</td>
                                </tr>
                                <tr>
                                    <td><strong>Session Resumption</strong></td>
                                    <td>Session IDs, Session Tickets</td>
                                    <td>PSK-based (session tickets still used for PSK delivery)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Cipher Suites -->
                <div class="subsection">
                    <h3 class="subsection-title">Cipher Suites</h3>
                    <p class="subsection-intro">
                        A cipher suite defines the algorithms used for each phase of the TLS connection: key exchange, authentication, bulk encryption, and message integrity. Understanding the naming format helps you choose secure configurations.
                    </p>

                    <!-- TLS 1.2 Format Breakdown -->
                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">TLS 1.2 Cipher Suite Format</h4>

                    <div class="glass-panel">
                        <div class="flow-diagram" style="flex-wrap: nowrap;">
                            <div class="flow-box flow-box-ruby" style="min-width: 80px;">
                                <div class="flow-label">TLS</div>
                                <div class="flow-sub">Protocol</div>
                            </div>
                            <div class="flow-arrow">_</div>
                            <div class="flow-box flow-box-amber" style="min-width: 100px;">
                                <div class="flow-label">ECDHE</div>
                                <div class="flow-sub">Key Exchange</div>
                            </div>
                            <div class="flow-arrow">_</div>
                            <div class="flow-box flow-box-sapphire" style="min-width: 80px;">
                                <div class="flow-label">RSA</div>
                                <div class="flow-sub">Authentication</div>
                            </div>
                            <div class="flow-arrow">_WITH_</div>
                            <div class="flow-box flow-box-emerald" style="min-width: 120px;">
                                <div class="flow-label">AES_256_GCM</div>
                                <div class="flow-sub">Bulk Cipher</div>
                            </div>
                            <div class="flow-arrow">_</div>
                            <div class="flow-box flow-box-amethyst" style="min-width: 100px;">
                                <div class="flow-label">SHA384</div>
                                <div class="flow-sub">MAC / PRF</div>
                            </div>
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">TLS 1.3 Simplified Format</h4>

                    <p>
                        TLS 1.3 separates key exchange from cipher suite naming. Cipher suites only specify the AEAD algorithm and hash, because key exchange is always (EC)DHE and authentication is determined by the certificate type.
                    </p>

                    <div class="glass-panel">
                        <div class="flow-diagram" style="flex-wrap: nowrap;">
                            <div class="flow-box flow-box-ruby" style="min-width: 80px;">
                                <div class="flow-label">TLS</div>
                                <div class="flow-sub">Protocol</div>
                            </div>
                            <div class="flow-arrow">_</div>
                            <div class="flow-box flow-box-emerald" style="min-width: 140px;">
                                <div class="flow-label">AES_256_GCM</div>
                                <div class="flow-sub">AEAD Cipher</div>
                            </div>
                            <div class="flow-arrow">_</div>
                            <div class="flow-box flow-box-amethyst" style="min-width: 100px;">
                                <div class="flow-label">SHA384</div>
                                <div class="flow-sub">HKDF Hash</div>
                            </div>
                        </div>
                    </div>

                    <!-- Recommended Modern Suites -->
                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Recommended Modern Cipher Suites</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Cipher Suite</th>
                                    <th>Protocol</th>
                                    <th>PFS</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>TLS_AES_256_GCM_SHA384</code></td>
                                    <td>TLS 1.3</td>
                                    <td><span class="badge badge-emerald"><span>Yes</span></span></td>
                                    <td>Strongest TLS 1.3 suite; 256-bit AES</td>
                                </tr>
                                <tr>
                                    <td><code>TLS_AES_128_GCM_SHA256</code></td>
                                    <td>TLS 1.3</td>
                                    <td><span class="badge badge-emerald"><span>Yes</span></span></td>
                                    <td>Default TLS 1.3 suite; excellent performance</td>
                                </tr>
                                <tr>
                                    <td><code>TLS_CHACHA20_POLY1305_SHA256</code></td>
                                    <td>TLS 1.3</td>
                                    <td><span class="badge badge-emerald"><span>Yes</span></span></td>
                                    <td>Preferred on devices without AES-NI hardware acceleration</td>
                                </tr>
                                <tr>
                                    <td><code>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</code></td>
                                    <td>TLS 1.2</td>
                                    <td><span class="badge badge-emerald"><span>Yes</span></span></td>
                                    <td>Best TLS 1.2 suite with RSA certificates</td>
                                </tr>
                                <tr>
                                    <td><code>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</code></td>
                                    <td>TLS 1.2</td>
                                    <td><span class="badge badge-emerald"><span>Yes</span></span></td>
                                    <td>Best TLS 1.2 suite with ECDSA certificates</td>
                                </tr>
                                <tr>
                                    <td><code>TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</code></td>
                                    <td>TLS 1.2</td>
                                    <td><span class="badge badge-emerald"><span>Yes</span></span></td>
                                    <td>Excellent for mobile/ARM devices (no AES-NI needed)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Deprecated Ciphers -->
                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Deprecated &amp; Weak Ciphers</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Cipher / Feature</th>
                                    <th>Status</th>
                                    <th>Vulnerability</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>TLS_RSA_WITH_AES_*</code> (RSA key exchange)</td>
                                    <td><span class="badge badge-ruby"><span>Avoid</span></span></td>
                                    <td>No PFS; ROBOT attack; removed in TLS 1.3</td>
                                </tr>
                                <tr>
                                    <td><code>*_CBC_*</code> (CBC mode ciphers)</td>
                                    <td><span class="badge badge-ruby"><span>Avoid</span></span></td>
                                    <td>BEAST, Lucky13, POODLE timing attacks</td>
                                </tr>
                                <tr>
                                    <td><code>RC4</code></td>
                                    <td><span class="badge badge-ruby"><span>Broken</span></span></td>
                                    <td>Statistical biases enable plaintext recovery (RFC 7465 prohibits)</td>
                                </tr>
                                <tr>
                                    <td><code>3DES</code> / <code>DES</code></td>
                                    <td><span class="badge badge-ruby"><span>Broken</span></span></td>
                                    <td>Sweet32 attack; 64-bit block size causes collisions</td>
                                </tr>
                                <tr>
                                    <td><code>MD5</code> / <code>SHA-1</code> (for signatures)</td>
                                    <td><span class="badge badge-ruby"><span>Broken</span></span></td>
                                    <td>Collision attacks demonstrated; CAs stopped issuing SHA-1 in 2016</td>
                                </tr>
                                <tr>
                                    <td><code>*_EXPORT_*</code> (export-grade)</td>
                                    <td><span class="badge badge-ruby"><span>Broken</span></span></td>
                                    <td>40/56-bit keys; FREAK and Logjam attacks</td>
                                </tr>
                                <tr>
                                    <td><code>*_NULL_*</code> (null encryption)</td>
                                    <td><span class="badge badge-ruby"><span>Broken</span></span></td>
                                    <td>No encryption at all; authentication only</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Server Configuration -->
                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Server Configuration</h4>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Nginx TLS Configuration</div>
                            <pre><code><span class="code-comment"># Modern configuration (TLS 1.3 + strong 1.2)</span>
<span class="code-keyword">ssl_protocols</span> TLSv1.2 TLSv1.3;

<span class="code-keyword">ssl_ciphers</span> <span class="code-string">'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256'</span>;

<span class="code-comment"># Server chooses cipher order</span>
<span class="code-keyword">ssl_prefer_server_ciphers</span> on;

<span class="code-comment"># TLS 1.3 suites (configured separately)</span>
<span class="code-keyword">ssl_conf_command</span> Ciphersuites <span class="code-string">TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256</span>;</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Apache TLS Configuration</div>
                            <pre><code><span class="code-comment"># Modern configuration</span>
<span class="code-keyword">SSLProtocol</span> all -SSLv3 -TLSv1 -TLSv1.1
<span class="code-keyword">SSLHonorCipherOrder</span> on

<span class="code-keyword">SSLCipherSuite</span> <span class="code-string">ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256</span>

<span class="code-comment"># TLS 1.3 cipher suites</span>
<span class="code-keyword">SSLCipherSuite</span> TLSv1.3 <span class="code-string">TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256</span></code></pre>
                        </div>
                    </div>
                </div>

                <!-- Perfect Forward Secrecy -->
                <div class="subsection">
                    <h3 class="subsection-title">Perfect Forward Secrecy</h3>
                    <p class="subsection-intro">
                        Perfect Forward Secrecy (PFS) ensures that if a server's long-term private key is compromised in the future, past recorded TLS sessions cannot be decrypted. Each session generates a unique ephemeral key pair that is discarded after use.
                    </p>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-ruby">Without PFS (RSA Key Exchange)</div>
                            <ul>
                                <li>Client encrypts pre-master secret with server's RSA public key</li>
                                <li>Same RSA key used for every session</li>
                                <li>If private key is stolen, ALL past sessions can be decrypted</li>
                                <li>Attacker with recorded traffic + stolen key = full plaintext</li>
                                <li>Removed in TLS 1.3</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-emerald">With PFS (ECDHE / DHE)</div>
                            <ul>
                                <li>Ephemeral Diffie-Hellman key pair generated per session</li>
                                <li>Server signs the ephemeral public key with its RSA/ECDSA cert</li>
                                <li>Session keys are derived from ephemeral exchange, then discarded</li>
                                <li>Compromised long-term key cannot decrypt past sessions</li>
                                <li>Mandatory in TLS 1.3</li>
                            </ul>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Feature</th>
                                    <th>ECDHE</th>
                                    <th>DHE</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Full Name</strong></td>
                                    <td>Elliptic Curve Diffie-Hellman Ephemeral</td>
                                    <td>Diffie-Hellman Ephemeral</td>
                                </tr>
                                <tr>
                                    <td><strong>Performance</strong></td>
                                    <td>Fast (smaller keys, hardware acceleration)</td>
                                    <td>Slower (larger parameters needed for equivalent security)</td>
                                </tr>
                                <tr>
                                    <td><strong>Key Size for 128-bit Security</strong></td>
                                    <td>256-bit curve (P-256 / X25519)</td>
                                    <td>3072-bit DH parameters</td>
                                </tr>
                                <tr>
                                    <td><strong>Recommended Curves</strong></td>
                                    <td>X25519 (best), P-256 (NIST), P-384</td>
                                    <td>ffdhe2048, ffdhe3072 (RFC 7919)</td>
                                </tr>
                                <tr>
                                    <td><strong>TLS 1.3 Status</strong></td>
                                    <td>Primary key exchange method</td>
                                    <td>Supported but rarely used</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Verify PFS Is Active</div>
                            <pre><code><span class="code-comment"># Check cipher suite of a live connection</span>
openssl s_client <span class="code-flag">-connect</span> example.com:443 \
  2>/dev/null | grep <span class="code-string">"Cipher    :"</span>

<span class="code-comment"># PFS active if result contains ECDHE or DHE:</span>
<span class="code-comment">#   Cipher: TLS_AES_256_GCM_SHA384 (TLS 1.3)</span>
<span class="code-comment">#   Cipher: ECDHE-RSA-AES256-GCM-SHA384 (TLS 1.2)</span>

<span class="code-comment"># Check server's supported key exchange</span>
openssl s_client <span class="code-flag">-connect</span> example.com:443 \
  2>/dev/null | grep <span class="code-string">"Server Temp Key"</span>

<span class="code-comment"># Expected: Server Temp Key: X25519, 253 bits</span>
<span class="code-comment"># or:       Server Temp Key: ECDH, P-256, 256 bits</span></code></pre>
                        </div>
                    </div>

                    <div class="alert alert-tip">
                        <div class="alert-title">Prefer X25519 Over P-256</div>
                        <div class="alert-body">
                            The X25519 curve (Curve25519) is faster, has a simpler implementation less prone to side-channel attacks, and is the default in TLS 1.3. While P-256 remains widely supported and secure, X25519 is the modern best practice for new deployments.
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <!-- ============================================================
             SECTION 06 — MUTUAL TLS (mTLS)
             ============================================================ -->
        <section id="mutual-tls" class="section">
            <div class="section-header">
                <div class="section-number">Section 06</div>
                <h2 class="section-title">Mutual TLS</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">Two-way certificate authentication for zero-trust architectures and service meshes.</p>
            </div>

            <div class="section-content">

                <!-- How mTLS Works -->
                <div class="subsection">
                    <h3 class="subsection-title">How mTLS Works</h3>
                    <p class="subsection-intro">
                        Standard TLS authenticates only the server: the client verifies the server's certificate, but the server has no cryptographic proof of the client's identity. Mutual TLS (mTLS) adds a second direction &mdash; the server also requests and verifies a client certificate, creating <strong>two-way authentication</strong>.
                    </p>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-sapphire">Standard TLS (One-Way)</div>
                            <ul>
                                <li>Client verifies server certificate</li>
                                <li>Server identity confirmed cryptographically</li>
                                <li>Client identity unknown to server</li>
                                <li>Client authenticated via application layer (passwords, tokens, API keys)</li>
                                <li>Sufficient for most public web applications</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-amber">Mutual TLS (Two-Way)</div>
                            <ul>
                                <li>Client verifies server certificate</li>
                                <li>Server verifies client certificate</li>
                                <li>Both parties authenticated at the transport layer</li>
                                <li>No passwords or tokens needed for identity</li>
                                <li>Required for zero-trust, service mesh, high-security APIs</li>
                            </ul>
                        </div>
                    </div>

                    <!-- mTLS Flow Diagram -->
                    <div class="glass-panel">
                        <div class="flow-diagram flow-vertical">
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">1. ClientHello</div>
                                <div class="flow-sub">Client initiates TLS handshake</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">2. ServerHello + Server Certificate</div>
                                <div class="flow-sub">Server sends its cert chain (same as standard TLS)</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-ruby" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">3. CertificateRequest</div>
                                <div class="flow-sub">Server requests client certificate (specifies acceptable CAs)</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">4. Client Certificate + CertificateVerify</div>
                                <div class="flow-sub">Client sends its cert and proves possession of private key</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">5. Server Validates Client Cert</div>
                                <div class="flow-sub">Chain verification, revocation check, CN/SAN extraction</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">6. Mutual Authentication Complete</div>
                                <div class="flow-sub">Both sides verified; encrypted channel established</div>
                            </div>
                        </div>
                    </div>

                    <!-- Use Cases -->
                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Common Use Cases</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Use Case</th>
                                    <th>Description</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Zero Trust</strong></td>
                                    <td>Authenticate every service-to-service call regardless of network position</td>
                                    <td>BeyondCorp, Google's internal network</td>
                                </tr>
                                <tr>
                                    <td><strong>Service Mesh</strong></td>
                                    <td>Sidecar proxies automatically handle mTLS between microservices</td>
                                    <td>Istio, Linkerd, Consul Connect</td>
                                </tr>
                                <tr>
                                    <td><strong>API Security</strong></td>
                                    <td>Restrict API access to clients with valid certificates</td>
                                    <td>Banking APIs, payment gateways, partner integrations</td>
                                </tr>
                                <tr>
                                    <td><strong>IoT Device Auth</strong></td>
                                    <td>Devices present unique certificates for identity</td>
                                    <td>AWS IoT Core, Azure IoT Hub</td>
                                </tr>
                                <tr>
                                    <td><strong>VPN / Network Access</strong></td>
                                    <td>Client certificates for VPN and 802.1X network authentication</td>
                                    <td>OpenVPN, WireGuard (with cert wrappers), enterprise Wi-Fi</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Configuration Examples -->
                <div class="subsection">
                    <h3 class="subsection-title">Configuration Examples</h3>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Nginx mTLS Configuration</div>
                            <pre><code>server {
    listen <span class="code-value">443</span> ssl;
    server_name <span class="code-string">api.example.com</span>;

    <span class="code-comment"># Server certificate</span>
    <span class="code-keyword">ssl_certificate</span>     <span class="code-path">/etc/ssl/server.crt</span>;
    <span class="code-keyword">ssl_certificate_key</span> <span class="code-path">/etc/ssl/server.key</span>;

    <span class="code-comment"># Client certificate verification</span>
    <span class="code-keyword">ssl_client_certificate</span> <span class="code-path">/etc/ssl/client-ca.crt</span>;
    <span class="code-keyword">ssl_verify_client</span> <span class="code-string">on</span>;
    <span class="code-keyword">ssl_verify_depth</span>  <span class="code-value">2</span>;

    <span class="code-comment"># Optional: CRL checking</span>
    <span class="code-keyword">ssl_crl</span> <span class="code-path">/etc/ssl/client-ca.crl</span>;

    <span class="code-comment"># Pass client cert info to upstream</span>
    location / {
        <span class="code-keyword">proxy_set_header</span> X-Client-DN
            $ssl_client_s_dn;
        <span class="code-keyword">proxy_set_header</span> X-Client-Verify
            $ssl_client_verify;
        <span class="code-keyword">proxy_pass</span> <span class="code-path">http://backend</span>;
    }
}</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Apache mTLS Configuration</div>
                            <pre><code>&lt;VirtualHost *:443&gt;
    ServerName <span class="code-string">api.example.com</span>

    <span class="code-comment"># Server certificate</span>
    <span class="code-keyword">SSLEngine</span> on
    <span class="code-keyword">SSLCertificateFile</span>    <span class="code-path">/etc/ssl/server.crt</span>
    <span class="code-keyword">SSLCertificateKeyFile</span> <span class="code-path">/etc/ssl/server.key</span>

    <span class="code-comment"># Client certificate verification</span>
    <span class="code-keyword">SSLCACertificateFile</span> <span class="code-path">/etc/ssl/client-ca.crt</span>
    <span class="code-keyword">SSLVerifyClient</span> require
    <span class="code-keyword">SSLVerifyDepth</span>  2

    <span class="code-comment"># Optional: CRL checking</span>
    <span class="code-keyword">SSLCARevocationFile</span> <span class="code-path">/etc/ssl/client-ca.crl</span>
    <span class="code-keyword">SSLCARevocationCheck</span> chain

    <span class="code-comment"># Pass client cert info to app</span>
    <span class="code-keyword">SSLOptions</span> +StdEnvVars +ExportCertData
&lt;/VirtualHost&gt;</code></pre>
                        </div>
                    </div>

                    <div class="alert alert-tip">
                        <div class="alert-title">Nginx ssl_verify_client Options</div>
                        <div class="alert-body">
                            <code>on</code> &mdash; Require valid client cert (rejects connections without one).<br>
                            <code>optional</code> &mdash; Request client cert but allow connections without one. Useful for endpoints that serve both authenticated and anonymous users.<br>
                            <code>optional_no_ca</code> &mdash; Request client cert but do not verify it against the CA. Used when the application layer handles verification.
                        </div>
                    </div>
                </div>

                <!-- Client Certificate Generation -->
                <div class="subsection">
                    <h3 class="subsection-title">Client Certificate Generation</h3>
                    <p class="subsection-intro">
                        Generating client certificates requires a private CA (or a designated sub-CA) that the server trusts. Here is the complete workflow from CA creation to PKCS#12 bundle:
                    </p>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Step 1: Create Client CA</div>
                            <pre><code><span class="code-comment"># Generate CA private key</span>
openssl genrsa <span class="code-flag">-out</span> <span class="code-path">client-ca.key</span> 4096

<span class="code-comment"># Create self-signed CA certificate</span>
openssl req <span class="code-flag">-new</span> <span class="code-flag">-x509</span> \
  <span class="code-flag">-key</span> <span class="code-path">client-ca.key</span> \
  <span class="code-flag">-out</span> <span class="code-path">client-ca.crt</span> \
  <span class="code-flag">-days</span> 3650 \
  <span class="code-flag">-subj</span> <span class="code-string">"/CN=Client CA/O=Example Inc."</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Step 2: Generate Client Key</div>
                            <pre><code><span class="code-comment"># Generate client private key</span>
openssl genrsa <span class="code-flag">-out</span> <span class="code-path">client.key</span> 2048

<span class="code-comment"># Or use EC key for better performance</span>
openssl ecparam <span class="code-flag">-genkey</span> \
  <span class="code-flag">-name</span> prime256v1 \
  <span class="code-flag">-out</span> <span class="code-path">client.key</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Step 3: Create Client CSR</div>
                            <pre><code><span class="code-comment"># Generate CSR with client identity</span>
openssl req <span class="code-flag">-new</span> \
  <span class="code-flag">-key</span> <span class="code-path">client.key</span> \
  <span class="code-flag">-out</span> <span class="code-path">client.csr</span> \
  <span class="code-flag">-subj</span> <span class="code-string">"/CN=service-a/O=Example Inc./OU=Engineering"</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Step 4: Sign Client Certificate</div>
                            <pre><code><span class="code-comment"># Sign with Client CA (valid 1 year)</span>
openssl x509 <span class="code-flag">-req</span> \
  <span class="code-flag">-in</span> <span class="code-path">client.csr</span> \
  <span class="code-flag">-CA</span> <span class="code-path">client-ca.crt</span> \
  <span class="code-flag">-CAkey</span> <span class="code-path">client-ca.key</span> \
  <span class="code-flag">-CAcreateserial</span> \
  <span class="code-flag">-out</span> <span class="code-path">client.crt</span> \
  <span class="code-flag">-days</span> 365 \
  <span class="code-flag">-extfile</span> &lt;(printf <span class="code-string">"extendedKeyUsage=clientAuth"</span>)</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Step 5: Create PKCS#12 Bundle</div>
                            <pre><code><span class="code-comment"># Bundle key + cert for browser/app import</span>
openssl pkcs12 <span class="code-flag">-export</span> \
  <span class="code-flag">-out</span> <span class="code-path">client.p12</span> \
  <span class="code-flag">-inkey</span> <span class="code-path">client.key</span> \
  <span class="code-flag">-in</span> <span class="code-path">client.crt</span> \
  <span class="code-flag">-certfile</span> <span class="code-path">client-ca.crt</span> \
  <span class="code-flag">-name</span> <span class="code-string">"Service A Client Cert"</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Test Client Certificate</div>
                            <pre><code><span class="code-comment"># Test mTLS connection with curl</span>
curl <span class="code-flag">--cert</span> <span class="code-path">client.crt</span> \
     <span class="code-flag">--key</span> <span class="code-path">client.key</span> \
     <span class="code-flag">--cacert</span> <span class="code-path">server-ca.crt</span> \
     https://api.example.com/health

<span class="code-comment"># Or using PKCS#12 bundle</span>
curl <span class="code-flag">--cert-type</span> P12 \
     <span class="code-flag">--cert</span> <span class="code-path">client.p12:password</span> \
     https://api.example.com/health</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Distribution Challenges -->
                <div class="subsection">
                    <h3 class="subsection-title">Distribution Challenges</h3>

                    <div class="alert alert-warning">
                        <div class="alert-title">Chrome Ending Public CA clientAuth Support</div>
                        <div class="alert-body">
                            Google announced that Chrome will <strong>stop trusting client certificates from public CAs</strong> for the <code>clientAuth</code> EKU by June 2026. Organizations relying on publicly-issued client certificates (e.g., from DigiCert or Sectigo) must migrate to private CAs for client authentication. This change does not affect server certificates or private CA-issued client certificates.
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Challenge</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Scale</strong></td>
                                    <td>Issuing and tracking certificates for thousands of clients, services, or devices requires automation far beyond manual OpenSSL commands</td>
                                </tr>
                                <tr>
                                    <td><strong>Secure Delivery</strong></td>
                                    <td>Private keys must reach the client securely; emailing PKCS#12 files is a common anti-pattern that exposes keys in transit and at rest</td>
                                </tr>
                                <tr>
                                    <td><strong>Lifecycle Management</strong></td>
                                    <td>Tracking expiration, handling renewal, revoking compromised certs across a fleet requires centralized tooling</td>
                                </tr>
                                <tr>
                                    <td><strong>Key Storage</strong></td>
                                    <td>Client private keys stored in filesystem are vulnerable; prefer TPM, secure enclave, or hardware tokens (PKCS#11)</td>
                                </tr>
                                <tr>
                                    <td><strong>Cross-Platform Support</strong></td>
                                    <td>Different OS and browsers handle client cert prompts differently; user experience varies widely</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Solutions</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Solution</th>
                                    <th>How It Helps</th>
                                    <th>Examples</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>CLM Platforms</strong></td>
                                    <td>Centralized issuance, renewal, revocation, and monitoring of all certificates</td>
                                    <td>Venafi, Keyfactor, Sectigo CLM, HashiCorp Vault PKI</td>
                                </tr>
                                <tr>
                                    <td><strong>Service Mesh</strong></td>
                                    <td>Automatic mTLS between services via sidecar proxies; no application changes needed</td>
                                    <td>Istio (Citadel), Linkerd, Consul Connect</td>
                                </tr>
                                <tr>
                                    <td><strong>MDM (Mobile Device Management)</strong></td>
                                    <td>Push client certificates to managed devices with secure key storage</td>
                                    <td>Jamf, Intune, Workspace ONE</td>
                                </tr>
                                <tr>
                                    <td><strong>SCEP / EST</strong></td>
                                    <td>Protocols for automated certificate enrollment and renewal by devices</td>
                                    <td>SCEP (legacy, widely supported), EST (RFC 7030, modern replacement)</td>
                                </tr>
                                <tr>
                                    <td><strong>SPIFFE/SPIRE</strong></td>
                                    <td>Workload identity framework; issues short-lived X.509 SVIDs automatically</td>
                                    <td>SPIRE (reference implementation), integrated into Istio, Envoy</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-info">
                        <div class="alert-title">Short-Lived Certificates Reduce Revocation Burden</div>
                        <div class="alert-body">
                            When client certificates have lifetimes of hours or minutes (as with SPIFFE/SPIRE or Istio), revocation becomes less critical because compromised certificates expire before they can be meaningfully exploited. This "short-lived certificate" pattern is a cornerstone of modern zero-trust architectures.
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <!-- ============================================================
             SECTION 07 — CERTIFICATE FORMATS & ENCODING
             ============================================================ -->
        <section id="cert-formats" class="section">
            <div class="section-header">
                <div class="section-number">Section 07</div>
                <h2 class="section-title">Certificate Formats &amp; Encoding</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">From human-readable PEM to binary keystores &mdash; every format, its purpose, and how to convert between them.</p>
            </div>

            <div class="section-content">

                <!-- Format Overview -->
                <div class="subsection">
                    <h3 class="subsection-title">Format Overview</h3>
                    <p class="subsection-intro">
                        Certificates and keys can be stored in several formats. The choice depends on the platform, the tool consuming the certificate, and whether you need to bundle the private key alongside the certificate chain.
                    </p>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Format</th>
                                    <th>Encoding</th>
                                    <th>Extensions</th>
                                    <th>Contains</th>
                                    <th>Platform</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>PEM</strong></td>
                                    <td>Base64</td>
                                    <td><code>.pem</code>, <code>.crt</code>, <code>.cer</code>, <code>.key</code></td>
                                    <td>Certificate, key, or chain</td>
                                    <td><span class="badge badge-emerald"><span>Linux / Unix</span></span></td>
                                </tr>
                                <tr>
                                    <td><strong>DER</strong></td>
                                    <td>Binary</td>
                                    <td><code>.der</code>, <code>.cer</code></td>
                                    <td>Certificate or key</td>
                                    <td><span class="badge badge-sapphire"><span>Windows, Java</span></span></td>
                                </tr>
                                <tr>
                                    <td><strong>PKCS#7 / P7B</strong></td>
                                    <td>Base64</td>
                                    <td><code>.p7b</code>, <code>.p7c</code></td>
                                    <td>Cert + chain (no private key)</td>
                                    <td><span class="badge badge-sapphire"><span>Windows, Java</span></span></td>
                                </tr>
                                <tr>
                                    <td><strong>PKCS#12 / PFX</strong></td>
                                    <td>Binary</td>
                                    <td><code>.pfx</code>, <code>.p12</code></td>
                                    <td>Cert + chain + private key</td>
                                    <td><span class="badge badge-amethyst"><span>Cross-platform</span></span></td>
                                </tr>
                                <tr>
                                    <td><strong>JKS</strong></td>
                                    <td>Binary</td>
                                    <td><code>.jks</code></td>
                                    <td>Cert + key (Java keystore)</td>
                                    <td><span class="badge badge-amber"><span>Java (legacy)</span></span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- PEM Format Detail -->
                <div class="subsection">
                    <h3 class="subsection-title">PEM Format</h3>
                    <p class="subsection-intro">
                        PEM (Privacy-Enhanced Mail) is the most common certificate format on Linux/Unix systems. It is Base64-encoded DER data wrapped with plain-text header and footer lines. A single <code>.pem</code> file can contain multiple objects concatenated together (e.g., a certificate followed by its chain).
                    </p>

                    <pre><code><span class="code-comment">-----BEGIN CERTIFICATE-----</span>
MIIFjTCCA3WgAwIBAgIRANOxciY0IzLc9AUoUSrsnGowDQYJKoZIhvcNAQEL
BQAwTzELMAkGA1UEBhMCVVMxKTAnBgNVBAoTIEludGVybmV0IFNlY3VyaXR5
IFJlc2VhcmNoIEdyb3VwMRUwEwYDVQQDEwxJU1JHIFJvb3QgWDEwHhcNMTYx
MDA2MTU0MzU1WhcNMjExMDA2MTU0MzU1WjBKMQswCQYDVQQGEwJVUzEWMBQG
<span class="code-comment">... (Base64-encoded DER data) ...</span>
<span class="code-comment">-----END CERTIFICATE-----</span>

<span class="code-comment">-----BEGIN RSA PRIVATE KEY-----</span>
MIIEpAIBAAKCAQEA0Z3VS5JJcds3xfn/ygWyF8PbnGy5AHB8VBjP...
<span class="code-comment">-----END RSA PRIVATE KEY-----</span>

<span class="code-comment"># Common PEM header types:</span>
<span class="code-comment"># -----BEGIN CERTIFICATE-----          (X.509 certificate)</span>
<span class="code-comment"># -----BEGIN RSA PRIVATE KEY-----      (PKCS#1 RSA key)</span>
<span class="code-comment"># -----BEGIN PRIVATE KEY-----          (PKCS#8 private key)</span>
<span class="code-comment"># -----BEGIN ENCRYPTED PRIVATE KEY---- (encrypted PKCS#8)</span>
<span class="code-comment"># -----BEGIN CERTIFICATE REQUEST-----  (CSR)</span></code></pre>

                    <div class="alert alert-tip">
                        <div class="alert-title">Most Common Format</div>
                        <div class="alert-body">
                            PEM is the default output format for OpenSSL and the expected input for most Linux-based servers (Nginx, Apache, HAProxy). When someone says "send me the certificate," they almost always mean PEM format.
                        </div>
                    </div>
                </div>

                <!-- DER Format Detail -->
                <div class="subsection">
                    <h3 class="subsection-title">DER Format</h3>
                    <p class="subsection-intro">
                        DER (Distinguished Encoding Rules) is the binary form of a certificate. PEM is simply Base64-encoded DER with header/footer lines added. DER files contain exactly one object (certificate or key) and cannot be concatenated like PEM.
                    </p>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-sapphire">DER Characteristics</div>
                            <ul>
                                <li>Raw binary ASN.1 encoding</li>
                                <li>Not human-readable (no BEGIN/END headers)</li>
                                <li>Smaller file size than PEM equivalent</li>
                                <li>Single object per file only</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-amber">Common Usage</div>
                            <ul>
                                <li>Java applications (native format for <code>keytool</code>)</li>
                                <li>Windows certificate stores</li>
                                <li>Embedded systems with limited storage</li>
                                <li>Any platform that doesn't need human inspection</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- PKCS#12 / PFX -->
                <div class="subsection">
                    <h3 class="subsection-title">PKCS#12 / PFX</h3>
                    <p class="subsection-intro">
                        PKCS#12 (also known as PFX) is a password-protected binary container that bundles a private key, its certificate, and the full certificate chain into a single file. It is the standard format for importing and exporting identity credentials across platforms.
                    </p>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-amethyst">What It Contains</div>
                            <ul>
                                <li>Private key (encrypted with password)</li>
                                <li>End-entity certificate</li>
                                <li>Intermediate and root CA certificates (chain)</li>
                                <li>Optional friendly name / alias metadata</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-amber">Common Use Cases</div>
                            <ul>
                                <li>Windows IIS server certificate import</li>
                                <li>Importing into macOS Keychain</li>
                                <li>Migrating certificates between servers</li>
                                <li>Client certificate distribution (user + key in one file)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="alert alert-warning">
                        <div class="alert-title">PFX Password Security</div>
                        <div class="alert-body">
                            The PKCS#12 password protects the private key inside the container. Use a strong password and never transmit the PFX file and its password through the same channel. Legacy PFX files may use weak encryption (RC2/3DES); modern tools default to AES-256.
                        </div>
                    </div>
                </div>

                <!-- JKS -->
                <div class="subsection">
                    <h3 class="subsection-title">Java KeyStore (JKS)</h3>
                    <p class="subsection-intro">
                        JKS is a proprietary Java keystore format that stores certificates and keys, protected by a keystore password and individual key passwords. Since Java 9, PKCS#12 is the default keystore format, and JKS is considered legacy.
                    </p>

                    <div class="alert alert-note">
                        <div class="alert-title">Deprecated Since Java 9</div>
                        <div class="alert-body">
                            Oracle deprecated JKS in favor of PKCS#12 starting with Java 9 (2017). New Java applications should use <code>-storetype PKCS12</code> with <code>keytool</code>. Existing JKS keystores can be converted using <code>keytool -importkeystore</code>. The JKS format is not portable outside the Java ecosystem.
                        </div>
                    </div>
                </div>

                <!-- Conversion Commands -->
                <div class="subsection">
                    <h3 class="subsection-title">Conversion Commands</h3>
                    <p class="subsection-intro">
                        A comprehensive reference for converting between certificate formats using <code>openssl</code> and <code>keytool</code>.
                    </p>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">PEM &rarr; DER</div>
                            <pre><code>openssl x509 <span class="code-flag">-outform</span> der \
  <span class="code-flag">-in</span> <span class="code-path">cert.pem</span> \
  <span class="code-flag">-out</span> <span class="code-path">cert.der</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">DER &rarr; PEM</div>
                            <pre><code>openssl x509 <span class="code-flag">-inform</span> der \
  <span class="code-flag">-in</span> <span class="code-path">cert.der</span> \
  <span class="code-flag">-out</span> <span class="code-path">cert.pem</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">PEM &rarr; PKCS#12</div>
                            <pre><code>openssl pkcs12 <span class="code-flag">-export</span> \
  <span class="code-flag">-out</span> <span class="code-path">cert.pfx</span> \
  <span class="code-flag">-inkey</span> <span class="code-path">private.key</span> \
  <span class="code-flag">-in</span> <span class="code-path">cert.pem</span> \
  <span class="code-flag">-certfile</span> <span class="code-path">chain.pem</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">PKCS#12 &rarr; PEM (All-in-One)</div>
                            <pre><code>openssl pkcs12 <span class="code-flag">-in</span> <span class="code-path">cert.pfx</span> \
  <span class="code-flag">-out</span> <span class="code-path">all.pem</span> \
  <span class="code-flag">-nodes</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">PKCS#12 &rarr; Separate Key</div>
                            <pre><code><span class="code-comment"># Extract private key only</span>
openssl pkcs12 <span class="code-flag">-in</span> <span class="code-path">cert.pfx</span> \
  <span class="code-flag">-nocerts</span> <span class="code-flag">-nodes</span> \
  <span class="code-flag">-out</span> <span class="code-path">private.key</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">PKCS#12 &rarr; Separate Cert</div>
                            <pre><code><span class="code-comment"># Extract certificate only</span>
openssl pkcs12 <span class="code-flag">-in</span> <span class="code-path">cert.pfx</span> \
  <span class="code-flag">-clcerts</span> <span class="code-flag">-nokeys</span> \
  <span class="code-flag">-out</span> <span class="code-path">cert.pem</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">PKCS#12 &rarr; Separate Chain</div>
                            <pre><code><span class="code-comment"># Extract CA chain only</span>
openssl pkcs12 <span class="code-flag">-in</span> <span class="code-path">cert.pfx</span> \
  <span class="code-flag">-cacerts</span> <span class="code-flag">-nokeys</span> \
  <span class="code-flag">-out</span> <span class="code-path">chain.pem</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">PEM &rarr; PKCS#7</div>
                            <pre><code>openssl crl2pkcs7 <span class="code-flag">-nocrl</span> \
  <span class="code-flag">-certfile</span> <span class="code-path">cert.pem</span> \
  <span class="code-flag">-certfile</span> <span class="code-path">chain.pem</span> \
  <span class="code-flag">-out</span> <span class="code-path">cert.p7b</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">PKCS#7 &rarr; PEM</div>
                            <pre><code>openssl pkcs7 \
  <span class="code-flag">-print_certs</span> \
  <span class="code-flag">-in</span> <span class="code-path">cert.p7b</span> \
  <span class="code-flag">-out</span> <span class="code-path">cert.pem</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">PEM &rarr; JKS (Two-Step)</div>
                            <pre><code><span class="code-comment"># Step 1: PEM → PKCS#12</span>
openssl pkcs12 <span class="code-flag">-export</span> \
  <span class="code-flag">-in</span> <span class="code-path">cert.pem</span> \
  <span class="code-flag">-inkey</span> <span class="code-path">private.key</span> \
  <span class="code-flag">-out</span> <span class="code-path">cert.p12</span> \
  <span class="code-flag">-name</span> <span class="code-string">myalias</span>

<span class="code-comment"># Step 2: PKCS#12 → JKS</span>
keytool <span class="code-flag">-importkeystore</span> \
  <span class="code-flag">-srckeystore</span> <span class="code-path">cert.p12</span> \
  <span class="code-flag">-srcstoretype</span> <span class="code-string">PKCS12</span> \
  <span class="code-flag">-destkeystore</span> <span class="code-path">keystore.jks</span> \
  <span class="code-flag">-deststoretype</span> <span class="code-string">JKS</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">JKS &rarr; PKCS#12</div>
                            <pre><code>keytool <span class="code-flag">-importkeystore</span> \
  <span class="code-flag">-srckeystore</span> <span class="code-path">keystore.jks</span> \
  <span class="code-flag">-srcstoretype</span> <span class="code-string">JKS</span> \
  <span class="code-flag">-destkeystore</span> <span class="code-path">keystore.p12</span> \
  <span class="code-flag">-deststoretype</span> <span class="code-string">PKCS12</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Find Alias in Keystore</div>
                            <pre><code>keytool <span class="code-flag">-list</span> <span class="code-flag">-v</span> \
  <span class="code-flag">-keystore</span> <span class="code-path">keystore.jks</span>

<span class="code-comment"># Show specific alias</span>
keytool <span class="code-flag">-list</span> <span class="code-flag">-v</span> \
  <span class="code-flag">-keystore</span> <span class="code-path">keystore.jks</span> \
  <span class="code-flag">-alias</span> <span class="code-string">myalias</span></code></pre>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <!-- ============================================================
             SECTION 08 — LET'S ENCRYPT & ACME
             ============================================================ -->
        <section id="lets-encrypt" class="section">
            <div class="section-header">
                <div class="section-number">Section 08</div>
                <h2 class="section-title">Let&rsquo;s Encrypt &amp; ACME</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">Free, automated, and open certificate issuance via the ACME protocol.</p>
            </div>

            <div class="section-content">

                <!-- ACME Protocol Flow -->
                <div class="subsection">
                    <h3 class="subsection-title">ACME Protocol Flow</h3>
                    <p class="subsection-intro">
                        ACME (Automatic Certificate Management Environment, RFC 8555) automates the entire certificate lifecycle. The client proves domain control to the CA, which then issues a signed certificate &mdash; all without human intervention.
                    </p>

                    <div class="glass-panel">
                        <div class="flow-diagram flow-vertical">
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">1. Account Registration</div>
                                <div class="flow-sub">Client creates an account with the ACME server (key pair + contact email)</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">2. Order Creation</div>
                                <div class="flow-sub">Client submits a new order for a certificate with desired domain names</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-ruby" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">3. Authorization</div>
                                <div class="flow-sub">Server returns challenges &mdash; one per domain &mdash; to prove control</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amethyst" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">4. Challenge Fulfillment</div>
                                <div class="flow-sub">Client places HTTP file, DNS TXT record, or responds via TLS-ALPN</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">5. Certificate Issuance</div>
                                <div class="flow-sub">CA validates challenges, signs the certificate, and returns it to the client</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Challenge Types -->
                <div class="subsection">
                    <h3 class="subsection-title">Challenge Types</h3>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Method</th>
                                    <th>Wildcard?</th>
                                    <th>Port</th>
                                    <th>Best For</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>HTTP-01</strong></td>
                                    <td>File at <code>/.well-known/acme-challenge/</code></td>
                                    <td><span class="badge badge-ruby"><span>No</span></span></td>
                                    <td>80</td>
                                    <td>Simple web servers, most common challenge type</td>
                                </tr>
                                <tr>
                                    <td><strong>DNS-01</strong></td>
                                    <td>TXT record on <code>_acme-challenge.domain</code></td>
                                    <td><span class="badge badge-emerald"><span>Yes</span></span></td>
                                    <td>None</td>
                                    <td>Wildcards, servers without port 80, DNS API automation</td>
                                </tr>
                                <tr>
                                    <td><strong>TLS-ALPN-01</strong></td>
                                    <td>TLS handshake with special ALPN extension</td>
                                    <td><span class="badge badge-ruby"><span>No</span></span></td>
                                    <td>443</td>
                                    <td>When only port 443 is available (no port 80)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-tip">
                        <div class="alert-title">Choosing a Challenge Type</div>
                        <div class="alert-body">
                            Use <strong>HTTP-01</strong> for simple setups where port 80 is open. Use <strong>DNS-01</strong> when you need wildcard certificates or your server is behind a firewall. <strong>TLS-ALPN-01</strong> is niche &mdash; primarily useful for reverse proxies that own port 443 but not port 80.
                        </div>
                    </div>
                </div>

                <!-- ACME Clients -->
                <div class="subsection">
                    <h3 class="subsection-title">ACME Clients</h3>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Certbot</h4>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Obtain Certificate (Standalone)</div>
                            <pre><code>certbot certonly <span class="code-flag">--standalone</span> \
  <span class="code-flag">-d</span> <span class="code-string">example.com</span> \
  <span class="code-flag">-d</span> <span class="code-string">www.example.com</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Obtain Certificate (Webroot)</div>
                            <pre><code>certbot certonly <span class="code-flag">--webroot</span> \
  <span class="code-flag">-w</span> <span class="code-path">/var/www/html</span> \
  <span class="code-flag">-d</span> <span class="code-string">example.com</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Obtain Wildcard (DNS-01)</div>
                            <pre><code>certbot certonly \
  <span class="code-flag">--dns-cloudflare</span> \
  <span class="code-flag">--dns-cloudflare-credentials</span> \
    <span class="code-path">~/.secrets/cloudflare.ini</span> \
  <span class="code-flag">-d</span> <span class="code-string">'*.example.com'</span> \
  <span class="code-flag">-d</span> <span class="code-string">example.com</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Renew All Certificates</div>
                            <pre><code>certbot renew

<span class="code-comment"># Dry run (test without renewing)</span>
certbot renew <span class="code-flag">--dry-run</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">List Managed Certificates</div>
                            <pre><code>certbot certificates</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Revoke a Certificate</div>
                            <pre><code>certbot revoke \
  <span class="code-flag">--cert-path</span> <span class="code-path">/etc/letsencrypt/live/example.com/cert.pem</span> \
  <span class="code-flag">--reason</span> <span class="code-string">keycompromise</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Use Staging Environment</div>
                            <pre><code>certbot certonly <span class="code-flag">--standalone</span> \
  <span class="code-flag">--staging</span> \
  <span class="code-flag">-d</span> <span class="code-string">test.example.com</span>

<span class="code-comment"># Staging certs are not trusted</span>
<span class="code-comment"># but don't count against rate limits</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Certbot with Nginx Plugin</div>
                            <pre><code>certbot <span class="code-flag">--nginx</span> \
  <span class="code-flag">-d</span> <span class="code-string">example.com</span> \
  <span class="code-flag">-d</span> <span class="code-string">www.example.com</span>

<span class="code-comment"># Auto-configures Nginx SSL blocks</span></code></pre>
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">acme.sh</h4>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Issue Certificate</div>
                            <pre><code>acme.sh <span class="code-flag">--issue</span> \
  <span class="code-flag">-d</span> <span class="code-string">example.com</span> \
  <span class="code-flag">-w</span> <span class="code-path">/var/www/html</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Install Certificate</div>
                            <pre><code>acme.sh <span class="code-flag">--install-cert</span> \
  <span class="code-flag">-d</span> <span class="code-string">example.com</span> \
  <span class="code-flag">--key-file</span> <span class="code-path">/etc/ssl/key.pem</span> \
  <span class="code-flag">--fullchain-file</span> <span class="code-path">/etc/ssl/fullchain.pem</span> \
  <span class="code-flag">--reloadcmd</span> <span class="code-string">"systemctl reload nginx"</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Renew Certificate</div>
                            <pre><code>acme.sh <span class="code-flag">--renew</span> \
  <span class="code-flag">-d</span> <span class="code-string">example.com</span> <span class="code-flag">--force</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Issue Wildcard (DNS API)</div>
                            <pre><code><span class="code-keyword">export</span> CF_Key=<span class="code-string">"your-api-key"</span>
<span class="code-keyword">export</span> CF_Email=<span class="code-string">"you@example.com"</span>

acme.sh <span class="code-flag">--issue</span> \
  <span class="code-flag">--dns</span> <span class="code-string">dns_cf</span> \
  <span class="code-flag">-d</span> <span class="code-string">'*.example.com'</span></code></pre>
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Caddy</h4>

                    <div class="alert alert-info">
                        <div class="alert-title">Automatic HTTPS with Zero Config</div>
                        <div class="alert-body">
                            Caddy automatically obtains and renews Let's Encrypt certificates for any domain name in its configuration. No ACME client setup, cron jobs, or renewal hooks are needed. Simply configure your domain and Caddy handles the rest:
                            <pre><code><span class="code-string">example.com</span> {
    <span class="code-keyword">reverse_proxy</span> <span class="code-path">localhost:3000</span>
}</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Rate Limits -->
                <div class="subsection">
                    <h3 class="subsection-title">Rate Limits</h3>

                    <div class="alert alert-warning">
                        <div class="alert-title">Let's Encrypt Rate Limits</div>
                        <div class="alert-body">
                            <strong>50 certificates</strong> per registered domain per week. Renewals of existing certificates (same set of domain names) do <em>not</em> count toward this limit. There is also a limit of <strong>5 failed validations</strong> per account, per hostname, per hour. Always use the <strong>staging environment</strong> for testing to avoid hitting production rate limits.
                        </div>
                    </div>
                </div>

                <!-- Auto-Renewal Setup -->
                <div class="subsection">
                    <h3 class="subsection-title">Auto-Renewal Setup</h3>
                    <p class="subsection-intro">
                        Let's Encrypt certificates are valid for 90 days. Automated renewal should run at least twice daily to ensure certificates are refreshed well before expiry (Certbot only renews within 30 days of expiration).
                    </p>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">systemd Timer (Recommended)</h4>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">certbot-renew.service</div>
                            <pre><code><span class="code-keyword">[Unit]</span>
Description=<span class="code-string">Certbot Renewal</span>

<span class="code-keyword">[Service]</span>
Type=<span class="code-string">oneshot</span>
ExecStart=<span class="code-path">/usr/bin/certbot</span> renew <span class="code-flag">--quiet</span> \
  <span class="code-flag">--deploy-hook</span> <span class="code-string">"systemctl reload nginx"</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">certbot-renew.timer</div>
                            <pre><code><span class="code-keyword">[Unit]</span>
Description=<span class="code-string">Run Certbot Twice Daily</span>

<span class="code-keyword">[Timer]</span>
OnCalendar=<span class="code-string">*-*-* 00,12:00:00</span>
RandomizedDelaySec=<span class="code-value">43200</span>
Persistent=<span class="code-string">true</span>

<span class="code-keyword">[Install]</span>
WantedBy=<span class="code-string">timers.target</span></code></pre>
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Cron Job Alternative</h4>

                    <pre><code><span class="code-comment"># Run twice daily at random minutes past the hour</span>
<span class="code-value">0</span> <span class="code-value">0,12</span> * * * root <span class="code-path">/usr/bin/certbot</span> renew <span class="code-flag">--quiet</span> <span class="code-flag">--deploy-hook</span> <span class="code-string">"systemctl reload nginx"</span></code></pre>

                    <div class="alert alert-tip">
                        <div class="alert-title">Why Twice Daily?</div>
                        <div class="alert-body">
                            Running renewal checks twice daily (as recommended by Let's Encrypt) ensures that even if one run fails due to a temporary network issue, the next attempt will succeed well before the certificate expires. The <code>RandomizedDelaySec</code> in the systemd timer spreads load across the day so all clients don't hit Let's Encrypt simultaneously.
                        </div>
                    </div>
                </div>

                <!-- Endpoints -->
                <div class="subsection">
                    <h3 class="subsection-title">ACME Endpoints</h3>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Environment</th>
                                    <th>Directory URL</th>
                                    <th>Purpose</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Production</strong></td>
                                    <td><code>https://acme-v02.api.letsencrypt.org/directory</code></td>
                                    <td>Trusted certificates for real deployments</td>
                                </tr>
                                <tr>
                                    <td><strong>Staging</strong></td>
                                    <td><code>https://acme-staging-v02.api.letsencrypt.org/directory</code></td>
                                    <td>Testing &mdash; untrusted certs, relaxed rate limits</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </section>

        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <!-- ============================================================
             SECTION 09 — ENTERPRISE & GOVERNMENT PKI
             ============================================================ -->
        <section id="enterprise-pki" class="section">
            <div class="section-header">
                <div class="section-number">Section 09</div>
                <h2 class="section-title">Enterprise &amp; Government PKI</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">On-premises certificate authorities, federal trust hierarchies, and smart card identity systems.</p>
            </div>

            <div class="section-content">

                <!-- Microsoft AD CS -->
                <div class="subsection">
                    <h3 class="subsection-title">Microsoft AD CS</h3>
                    <p class="subsection-intro">
                        Active Directory Certificate Services (AD CS) is Microsoft's enterprise PKI platform. It integrates deeply with Active Directory for automated certificate enrollment, Group Policy distribution, and template-based issuance.
                    </p>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-sapphire">Standalone CA</div>
                            <ul>
                                <li>No Active Directory integration</li>
                                <li>Manual certificate request and approval</li>
                                <li>Typically used as an offline root CA</li>
                                <li>Can be installed on non-domain-joined servers</li>
                                <li>No auto-enrollment support</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-amber">Enterprise CA</div>
                            <ul>
                                <li>Requires Active Directory domain membership</li>
                                <li>Certificate templates for standardized issuance</li>
                                <li>Auto-enrollment via Group Policy</li>
                                <li>Publishes certificates and CRLs to AD</li>
                                <li>Used as issuing CA in production environments</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Two-Tier Deployment -->
                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Two-Tier PKI Deployment</h4>

                    <div class="glass-panel">
                        <div class="flow-diagram flow-vertical">
                            <div class="flow-box flow-box-ruby" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">Offline Root CA</div>
                                <div class="flow-sub">Standalone CA, air-gapped, signs only subordinate CA certs</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">Online Issuing CA</div>
                                <div class="flow-sub">Enterprise CA, domain-joined, issues end-entity certificates</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">Certificate Templates</div>
                                <div class="flow-sub">Define key usage, validity, subject format, and enrollment permissions</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">Auto-Enrollment (Group Policy)</div>
                                <div class="flow-sub">Domain computers and users automatically request and receive certificates</div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <div class="alert-title">Certificate Templates</div>
                        <div class="alert-body">
                            AD CS certificate templates define the properties of issued certificates: key usage, validity period, subject name format, cryptographic provider, and which users or computers can enroll. Templates are configured in the Certificate Templates console and published to Active Directory for enterprise CAs to use.
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Auto-Enrollment via Group Policy</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Step</th>
                                    <th>Action</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>1</strong></td>
                                    <td>Configure certificate template</td>
                                    <td>Set permissions to allow "Autoenroll" for target users/computers</td>
                                </tr>
                                <tr>
                                    <td><strong>2</strong></td>
                                    <td>Publish template on Enterprise CA</td>
                                    <td>CA console &rarr; Certificate Templates &rarr; New &rarr; select template</td>
                                </tr>
                                <tr>
                                    <td><strong>3</strong></td>
                                    <td>Create or edit Group Policy Object</td>
                                    <td>Computer/User Configuration &rarr; Policies &rarr; Windows Settings &rarr; Security Settings &rarr; Public Key Policies</td>
                                </tr>
                                <tr>
                                    <td><strong>4</strong></td>
                                    <td>Enable auto-enrollment</td>
                                    <td>Certificate Services Client &ndash; Auto-Enrollment &rarr; Enabled; check "Renew expired" and "Update templates"</td>
                                </tr>
                                <tr>
                                    <td><strong>5</strong></td>
                                    <td>Apply and verify</td>
                                    <td>Run <code>gpupdate /force</code>, then verify via <code>certlm.msc</code> or <code>certmgr.msc</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-note">
                        <div class="alert-title">Key Archival &amp; Web Enrollment</div>
                        <div class="alert-body">
                            <strong>Key Archival</strong>: AD CS can archive private keys for key management certificates (encryption keys), enabling recovery if a user's key is lost. This requires a Key Recovery Agent (KRA) certificate. <strong>Web Enrollment</strong>: The Certificate Enrollment Web Service (CES) and Certificate Enrollment Policy Web Service (CEP) enable certificate enrollment over HTTPS for non-domain-joined devices and cross-forest scenarios.
                        </div>
                    </div>
                </div>

                <!-- EJBCA & Alternatives -->
                <div class="subsection">
                    <h3 class="subsection-title">EJBCA &amp; Alternatives</h3>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Solution</th>
                                    <th>Type</th>
                                    <th>License</th>
                                    <th>Best For</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Microsoft AD CS</strong></td>
                                    <td>Enterprise CA</td>
                                    <td>Windows Server license</td>
                                    <td>Windows-centric environments with Active Directory</td>
                                </tr>
                                <tr>
                                    <td><strong>EJBCA</strong></td>
                                    <td>Enterprise CA</td>
                                    <td>Open source (LGPL) + Enterprise</td>
                                    <td>Large-scale PKI, cross-platform, regulatory compliance</td>
                                </tr>
                                <tr>
                                    <td><strong>step-ca</strong></td>
                                    <td>Internal CA</td>
                                    <td>Open source (Apache 2.0)</td>
                                    <td>DevOps, microservices, short-lived certs, ACME for internal use</td>
                                </tr>
                                <tr>
                                    <td><strong>HashiCorp Vault PKI</strong></td>
                                    <td>Secrets engine</td>
                                    <td>Open source (BSL) + Enterprise</td>
                                    <td>Dynamic secrets, service mesh integration, API-driven cert issuance</td>
                                </tr>
                                <tr>
                                    <td><strong>CFSSL</strong></td>
                                    <td>CLI / API toolkit</td>
                                    <td>Open source (BSD)</td>
                                    <td>Lightweight internal CA, CI/CD pipelines, Kubernetes</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Use Case</th>
                                    <th>Recommended Tool</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Windows domain with Group Policy auto-enrollment</td>
                                    <td><strong>AD CS</strong></td>
                                </tr>
                                <tr>
                                    <td>Multi-platform enterprise with compliance requirements (eIDAS, WebTrust)</td>
                                    <td><strong>EJBCA</strong></td>
                                </tr>
                                <tr>
                                    <td>Internal microservices needing automated short-lived certs</td>
                                    <td><strong>step-ca</strong> or <strong>Vault PKI</strong></td>
                                </tr>
                                <tr>
                                    <td>Kubernetes cluster certificate management</td>
                                    <td><strong>CFSSL</strong> or <strong>step-ca</strong> (with cert-manager)</td>
                                </tr>
                                <tr>
                                    <td>HashiCorp ecosystem with dynamic secrets</td>
                                    <td><strong>Vault PKI</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Federal PKI -->
                <div class="subsection">
                    <h3 class="subsection-title">Federal PKI (FPKI)</h3>
                    <p class="subsection-intro">
                        The Federal Public Key Infrastructure (FPKI) is the U.S. government's trust framework for digital identity and certificate management. It enables secure, interoperable digital signatures and authentication across federal agencies and with external partners.
                    </p>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Federal Bridge CA (FBCA)</h4>

                    <p>
                        The Federal Bridge Certification Authority (FBCA) acts as a trust anchor that enables cross-certification between federal agencies, state governments, and external partners. Rather than each agency trusting every other agency's root CA, they each cross-certify with the FBCA, creating a hub-and-spoke trust model.
                    </p>

                    <div class="glass-panel">
                        <div class="flow-diagram flow-vertical">
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">Federal Bridge CA (FBCA)</div>
                                <div class="flow-sub">Hub of trust &mdash; cross-certifies with each agency CA</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">Agency CAs</div>
                                <div class="flow-sub">DoD, Treasury, DHS, etc. &mdash; each with own PKI hierarchy</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">End-Entity Certificates</div>
                                <div class="flow-sub">PIV cards, digital signatures, server auth, email encryption</div>
                            </div>
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">FPKI Assurance Levels</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Level</th>
                                    <th>Name</th>
                                    <th>Identity Proofing</th>
                                    <th>Token</th>
                                    <th>Use Case</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>1</strong></td>
                                    <td>Rudimentary</td>
                                    <td>Self-asserted</td>
                                    <td>Software</td>
                                    <td>Low-value transactions, public web forms</td>
                                </tr>
                                <tr>
                                    <td><strong>2</strong></td>
                                    <td>Basic</td>
                                    <td>Remote identity verification</td>
                                    <td>Software</td>
                                    <td>Internal applications, non-sensitive data access</td>
                                </tr>
                                <tr>
                                    <td><strong>3</strong></td>
                                    <td>Medium</td>
                                    <td>In-person or supervised remote</td>
                                    <td>Hardware or software</td>
                                    <td>Government email, document signing, building access</td>
                                </tr>
                                <tr>
                                    <td><strong>4</strong></td>
                                    <td>Medium Hardware</td>
                                    <td>In-person with government ID</td>
                                    <td>Hardware (PIV card)</td>
                                    <td>Logical and physical access, PIV authentication</td>
                                </tr>
                                <tr>
                                    <td><strong>5</strong></td>
                                    <td>High</td>
                                    <td>In-person with biometrics</td>
                                    <td>Hardware (FIPS 140-2 Level 3+)</td>
                                    <td>National security systems, classified networks</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- PIV & CAC Cards -->
                <div class="subsection">
                    <h3 class="subsection-title">PIV &amp; CAC Cards</h3>
                    <p class="subsection-intro">
                        Personal Identity Verification (PIV) and Common Access Card (CAC) are smart card-based identity credentials used across the U.S. federal government and Department of Defense.
                    </p>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-sapphire">PIV (FIPS 201-3)</div>
                            <ul>
                                <li>Mandated by HSPD-12 for all federal employees and contractors</li>
                                <li>Smart card with PKI certificates, PIN, and biometrics</li>
                                <li>Used for logical access (computer login, VPN) and physical access (building entry)</li>
                                <li>Governed by NIST SP 800-73 (interfaces) and SP 800-76 (biometrics)</li>
                                <li>Contains four X.509 certificates (see table below)</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-amber">CAC (Common Access Card)</div>
                            <ul>
                                <li>Department of Defense (DoD) smart card identity credential</li>
                                <li>Functions as military ID, Geneva Convention card, and PKI token</li>
                                <li>Contains DoD PKI certificates for authentication and signing</li>
                                <li>Required for DoD network access (NIPRNet, SIPRNet portals)</li>
                                <li>Transitioning toward PIV interoperability</li>
                            </ul>
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">PIV Certificate Types</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Certificate</th>
                                    <th>OID / Key Usage</th>
                                    <th>PIN Required</th>
                                    <th>Purpose</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>PIV Authentication</strong></td>
                                    <td>Digital Signature, Key Agreement</td>
                                    <td>Yes</td>
                                    <td>Login to systems, VPN, web authentication (primary identity cert)</td>
                                </tr>
                                <tr>
                                    <td><strong>Digital Signature</strong></td>
                                    <td>Digital Signature, Non-Repudiation</td>
                                    <td>Yes (always)</td>
                                    <td>Signing emails and documents (legally binding)</td>
                                </tr>
                                <tr>
                                    <td><strong>Key Management</strong></td>
                                    <td>Key Encipherment, Key Agreement</td>
                                    <td>Yes</td>
                                    <td>Encrypting email (S/MIME) and files; key is archivable for recovery</td>
                                </tr>
                                <tr>
                                    <td><strong>Card Authentication</strong></td>
                                    <td>Digital Signature</td>
                                    <td>No</td>
                                    <td>Contactless physical access (door readers); no PIN needed for speed</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- NIST SP 800-57 -->
                <div class="subsection">
                    <h3 class="subsection-title">NIST SP 800-57: Key Management</h3>
                    <p class="subsection-intro">
                        NIST Special Publication 800-57 provides comprehensive recommendations for cryptographic key management, including key lifecycle, algorithm selection, and cryptoperiods (how long a key should be used).
                    </p>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Key Lifecycle Stages</h4>

                    <div class="glass-panel">
                        <div class="flow-diagram flow-vertical">
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">1. Pre-Activation</div>
                                <div class="flow-sub">Key generated but not yet authorized for use</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">2. Active</div>
                                <div class="flow-sub">Key is in normal use for cryptographic operations</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">3. Deactivated</div>
                                <div class="flow-sub">Key no longer used for new operations; may still decrypt/verify existing data</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amethyst" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">4. Compromised</div>
                                <div class="flow-sub">Key integrity or confidentiality is in doubt; revoke immediately</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-ruby" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">5. Destroyed</div>
                                <div class="flow-sub">Key material is irreversibly erased from all storage</div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <div class="alert-title">Cryptoperiods</div>
                        <div class="alert-body">
                            A <strong>cryptoperiod</strong> is the time span during which a specific key is authorized for use. NIST SP 800-57 recommends different cryptoperiods depending on key type: <strong>1&ndash;3 years</strong> for symmetric encryption keys, <strong>1&ndash;3 years</strong> for private signing keys, and <strong>1&ndash;2 years</strong> for public key transport keys. Shorter cryptoperiods limit exposure if a key is compromised.
                        </div>
                    </div>

                    <div class="alert alert-note">
                        <div class="alert-title">Post-Quantum Considerations (Revision 6 Draft)</div>
                        <div class="alert-body">
                            The draft Revision 6 of SP 800-57 incorporates guidance for post-quantum cryptographic algorithms (NIST PQC standards ML-KEM, ML-DSA, SLH-DSA). Organizations should begin planning hybrid deployments that pair classical algorithms with post-quantum algorithms to maintain security against future quantum computers while retaining backward compatibility.
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <!-- ============================================================
             SECTION 10 — KEY MANAGEMENT & HSMs
             ============================================================ -->
        <section id="key-management" class="section">
            <div class="section-header">
                <div class="section-number">Section 10</div>
                <h2 class="section-title">Key Management &amp; HSMs</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">Hardware security modules, key ceremonies, and the full lifecycle of cryptographic keys.</p>
            </div>

            <div class="section-content">

                <!-- What HSMs Are -->
                <div class="subsection">
                    <h3 class="subsection-title">Hardware Security Modules</h3>
                    <p class="subsection-intro">
                        A Hardware Security Module (HSM) is a dedicated, tamper-resistant physical device that generates, stores, and manages cryptographic keys. HSMs perform cryptographic operations (signing, encryption, decryption) internally so that private keys never leave the protected hardware boundary.
                    </p>

                    <p>
                        HSMs matter because they provide a <strong>root of trust</strong> for PKI deployments. Software-based key storage is vulnerable to memory extraction, malware, and insider threats. HSMs address these risks through tamper-resistant enclosures, dedicated cryptographic processors, and strict access controls that meet regulatory requirements such as FIPS 140, Common Criteria, and PCI DSS.
                    </p>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">HSM Types</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Examples</th>
                                    <th>Form Factor</th>
                                    <th>Use Case</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Network-attached</strong></td>
                                    <td>Thales Luna, Entrust nShield</td>
                                    <td>Rack-mounted appliance</td>
                                    <td>Enterprise, high-throughput TLS offload, CA signing</td>
                                </tr>
                                <tr>
                                    <td><strong>USB tokens</strong></td>
                                    <td>YubiHSM 2, Luna USB</td>
                                    <td>USB device</td>
                                    <td>Offline root CA, small deployments, dev/test</td>
                                </tr>
                                <tr>
                                    <td><strong>Cloud HSMs</strong></td>
                                    <td>AWS CloudHSM, Azure Dedicated HSM, GCP Cloud HSM</td>
                                    <td>Cloud service</td>
                                    <td>Cloud-native applications, managed infrastructure</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">FIPS 140 Validation Levels</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Level</th>
                                    <th>Requirements</th>
                                    <th>Physical Security</th>
                                    <th>Common Use</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span class="badge badge-sapphire"><span>Level 1</span></span></td>
                                    <td>Basic requirements; at least one approved algorithm</td>
                                    <td>No specific physical security beyond production-grade components</td>
                                    <td>Software-only implementations</td>
                                </tr>
                                <tr>
                                    <td><span class="badge badge-emerald"><span>Level 2</span></span></td>
                                    <td>Tamper-evident seals, role-based authentication</td>
                                    <td>Tamper-evident coatings or seals; pick-resistant locks</td>
                                    <td>General-purpose HSMs</td>
                                </tr>
                                <tr>
                                    <td><span class="badge badge-amber"><span>Level 3</span></span></td>
                                    <td>Tamper-resistant, identity-based authentication</td>
                                    <td>Active tamper response (zeroization); hard epoxy enclosure</td>
                                    <td>CA root keys, code signing (most common for CAs)</td>
                                </tr>
                                <tr>
                                    <td><span class="badge badge-ruby"><span>Level 4</span></span></td>
                                    <td>Complete physical protection, environmental failure protection</td>
                                    <td>Envelope of protection; environmental failure protection (temperature, voltage)</td>
                                    <td>Government classified systems, high-security environments</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- PKCS#11 Interface -->
                <div class="subsection">
                    <h3 class="subsection-title">PKCS#11 Interface</h3>
                    <p class="subsection-intro">
                        PKCS#11 (also called "Cryptoki") is the standard API for communicating with HSMs and other cryptographic tokens. Defined by RSA Laboratories (now OASIS), it provides a vendor-neutral C interface that applications use to perform key generation, signing, encryption, and other operations without direct access to key material.
                    </p>

                    <p>
                        Most HSM vendors ship a PKCS#11 shared library (<code>.so</code> on Linux, <code>.dll</code> on Windows) that OpenSSL, Java (via SunPKCS11 provider), and other applications load to interact with the hardware. This abstraction allows swapping HSM vendors without rewriting application code.
                    </p>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">OpenSSL with PKCS#11 engine</div>
                            <pre><code><span class="code-comment"># Configure OpenSSL to use HSM via PKCS#11</span>
openssl req -new -x509 \
  -engine pkcs11 \
  -keyform engine \
  -key "pkcs11:token=MyHSM;object=root-ca-key" \
  -out root-ca.crt -days 3650 \
  -subj "/CN=Root CA"</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">List tokens with pkcs11-tool</div>
                            <pre><code><span class="code-comment"># List available tokens</span>
pkcs11-tool --module /usr/lib/libCryptoki2.so \
  --list-tokens

<span class="code-comment"># List objects on a specific token</span>
pkcs11-tool --module /usr/lib/libCryptoki2.so \
  --list-objects --login</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Key Ceremony Procedures -->
                <div class="subsection">
                    <h3 class="subsection-title">Key Ceremony Procedures</h3>
                    <p class="subsection-intro">
                        A <strong>key ceremony</strong> is a formally documented, witnessed process for generating, activating, or revoking a critical cryptographic key&mdash;typically a root CA key. Key ceremonies enforce dual control and split knowledge to prevent any single person from accessing or misusing key material.
                    </p>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-sapphire">Dual Control</div>
                            <ul>
                                <li>Two or more people must participate to complete a sensitive operation</li>
                                <li>No single individual can perform the action alone</li>
                                <li>Physical presence of multiple key custodians required</li>
                                <li>Enforced by HSM configuration (M-of-N quorum)</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-amber">Split Knowledge</div>
                            <ul>
                                <li>No single person knows the complete secret</li>
                                <li>Key material or activation data is divided into shares</li>
                                <li>Each custodian holds only their share</li>
                                <li>Shares are stored in sealed tamper-evident envelopes in separate safes</li>
                            </ul>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <div class="alert-title">M-of-N Quorum</div>
                        <div class="alert-body">
                            An <strong>M-of-N quorum</strong> requires that M out of N total key custodians must present their shares to activate the HSM or perform a signing operation. A common configuration is <strong>3-of-5</strong>: five custodians each hold a share, and any three of them can authorize a key operation. This provides redundancy (two custodians can be unavailable) while maintaining security (three colluding individuals are needed to compromise the key).
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Root CA Key Ceremony Steps</h4>

                    <div class="glass-panel">
                        <div class="flow-diagram flow-vertical">
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">1. Preparation</div>
                                <div class="flow-sub">Air-gapped room; HSM, laptop, and media verified; attendees identified and logged</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">2. HSM Initialization</div>
                                <div class="flow-sub">HSM is factory-reset and initialized with a new security world / partition</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">3. Key Share Distribution</div>
                                <div class="flow-sub">M-of-N custodians each receive a sealed smart card or passphrase share</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">4. Root Key Generation</div>
                                <div class="flow-sub">Root CA key pair generated inside the HSM; private key never exported</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">5. Root Certificate Signing</div>
                                <div class="flow-sub">Self-signed root certificate created with long validity (15&ndash;25 years)</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amethyst" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">6. Verification &amp; Audit</div>
                                <div class="flow-sub">Certificate hash verified; all actions logged; ceremony script signed by witnesses</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-ruby" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">7. Secure Storage</div>
                                <div class="flow-sub">HSM powered down and stored in safe; key shares distributed to separate secure locations</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key Lifecycle -->
                <div class="subsection">
                    <h3 class="subsection-title">Key Lifecycle</h3>
                    <p class="subsection-intro">
                        Every cryptographic key follows a lifecycle from creation to destruction. Proper lifecycle management ensures keys are used securely, rotated before compromise, and destroyed when no longer needed.
                    </p>

                    <div class="glass-panel">
                        <div class="flow-diagram flow-vertical">
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">1. Generation</div>
                                <div class="flow-sub">Key pair created using cryptographically secure random number generator (inside HSM or OS CSPRNG)</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">2. Distribution</div>
                                <div class="flow-sub">Public key distributed via certificate; private key securely provisioned to authorized systems</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">3. Storage</div>
                                <div class="flow-sub">Private key protected at rest: HSM, encrypted keystore, TPM, or secure enclave</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">4. Usage</div>
                                <div class="flow-sub">Key performs signing, encryption, or authentication within its authorized scope</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">5. Rotation</div>
                                <div class="flow-sub">New key generated and phased in before the current key's cryptoperiod expires</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amethyst" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">6. Archival</div>
                                <div class="flow-sub">Retired key preserved in secure storage for decrypting historical data or audit purposes</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-ruby" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">7. Destruction</div>
                                <div class="flow-sub">Key material irreversibly erased from all storage media using secure zeroization</div>
                            </div>
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Key Escrow vs Key Recovery</h4>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-sapphire">Key Escrow</div>
                            <ul>
                                <li>Copy of private key stored with a trusted third party</li>
                                <li>Third party can decrypt data if original key holder is unavailable</li>
                                <li>Used for encryption keys (never for signing keys)</li>
                                <li>Controversial: creates a single point of compromise</li>
                                <li>Required in some regulatory contexts (e.g., AD CS key archival)</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-amber">Key Recovery</div>
                            <ul>
                                <li>Mechanism to reconstruct a key from stored recovery data</li>
                                <li>Often implemented with M-of-N secret sharing (Shamir's scheme)</li>
                                <li>No single party holds the complete key</li>
                                <li>Recovery requires quorum of key recovery agents</li>
                                <li>Preferred over escrow for security-sensitive deployments</li>
                            </ul>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <!-- ============================================================
             SECTION 11 — ADVANCED TOPICS
             ============================================================ -->
        <section id="advanced-topics" class="section">
            <div class="section-header">
                <div class="section-number">Section 11</div>
                <h2 class="section-title">Advanced Topics</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">Code signing, S/MIME email security, certificate pinning, and Certificate Transparency.</p>
            </div>

            <div class="section-content">

                <!-- Code Signing -->
                <div class="subsection">
                    <h3 class="subsection-title">Code Signing</h3>
                    <p class="subsection-intro">
                        Code signing uses digital signatures to verify the <strong>integrity</strong> (code has not been tampered with) and <strong>attribution</strong> (code comes from a known publisher) of software. It is a critical component of supply chain security&mdash;operating systems, app stores, and enterprise policies use code signatures to decide whether software is trusted.
                    </p>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Platform Signing Tools</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Platform</th>
                                    <th>Tool</th>
                                    <th>Signature Format</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Windows</strong></td>
                                    <td><code>signtool</code></td>
                                    <td>Authenticode (PE/COFF, MSI, MSIX)</td>
                                    <td>Requires code signing certificate from trusted CA; supports HSM via CSP/KSP</td>
                                </tr>
                                <tr>
                                    <td><strong>macOS</strong></td>
                                    <td><code>codesign</code></td>
                                    <td>Apple Code Signing (Mach-O)</td>
                                    <td>Requires Apple Developer ID certificate; notarization required for distribution</td>
                                </tr>
                                <tr>
                                    <td><strong>Java</strong></td>
                                    <td><code>jarsigner</code></td>
                                    <td>JAR signatures (MANIFEST.MF)</td>
                                    <td>Signs JAR/WAR/EAR archives; supports PKCS#11 keystores</td>
                                </tr>
                                <tr>
                                    <td><strong>Linux (RPM)</strong></td>
                                    <td><code>rpmsign</code></td>
                                    <td>RPM GPG signatures</td>
                                    <td>Uses GPG key; verified by <code>rpm --checksig</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Linux (DEB)</strong></td>
                                    <td><code>dpkg-sig</code></td>
                                    <td>Debian package signatures</td>
                                    <td>Repository-level signing via <code>apt-secure</code> / Release.gpg</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-info">
                        <div class="alert-title">Timestamping (RFC 3161)</div>
                        <div class="alert-body">
                            A <strong>timestamp</strong> proves that code was signed <em>before</em> the signing certificate expired or was revoked. Without a timestamp, signatures become invalid when the certificate expires. RFC 3161 defines the Timestamp Protocol: the signing tool sends a hash to a Timestamp Authority (TSA), which returns a signed timestamp token embedded in the signature. Always use <code>/tr</code> (RFC 3161) rather than <code>/t</code> (legacy Authenticode) with signtool.
                        </div>
                    </div>

                    <div class="alert alert-note">
                        <div class="alert-title">EV Code Signing</div>
                        <div class="alert-body">
                            Extended Validation (EV) code signing certificates require the private key to be stored on a FIPS 140-2 Level 2+ hardware token (USB or HSM). EV-signed drivers are required for Windows kernel-mode code. EV certificates also provide immediate SmartScreen reputation on Windows, bypassing the gradual trust-building that standard certificates require.
                        </div>
                    </div>

                    <div class="alert alert-tip">
                        <div class="alert-title">CI/CD Integration</div>
                        <div class="alert-body">
                            For automated signing pipelines, store the signing key in a cloud HSM (AWS CloudHSM, Azure Key Vault HSM, GCP Cloud HSM) and access it via PKCS#11 or the cloud provider's SDK. Never store code signing private keys as CI/CD secrets or environment variables. Use short-lived signing sessions with audit logging, and restrict signing to tagged release builds only.
                        </div>
                    </div>
                </div>

                <!-- S/MIME for Email -->
                <div class="subsection">
                    <h3 class="subsection-title">S/MIME for Email</h3>
                    <p class="subsection-intro">
                        S/MIME (Secure/Multipurpose Internet Mail Extensions) uses X.509 certificates to provide <strong>digital signatures</strong> and <strong>encryption</strong> for email messages. It is the standard for enterprise email security, supported natively by Outlook, Apple Mail, and Thunderbird.
                    </p>

                    <div class="comparison-grid">
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-sapphire">S/MIME Signing</div>
                            <ul>
                                <li>Sender signs with their <strong>private key</strong></li>
                                <li>Recipient verifies with sender's <strong>public key</strong> (from certificate)</li>
                                <li>Proves sender identity and message integrity</li>
                                <li>Does not hide message content</li>
                                <li>Certificate must have <code>emailProtection</code> EKU</li>
                            </ul>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-panel-title title-amber">S/MIME Encryption</div>
                            <ul>
                                <li>Sender encrypts with recipient's <strong>public key</strong></li>
                                <li>Recipient decrypts with their <strong>private key</strong></li>
                                <li>Only the intended recipient can read the message</li>
                                <li>Requires sender to have recipient's certificate in advance</li>
                                <li>Can be combined with signing (sign-then-encrypt)</li>
                            </ul>
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">S/MIME vs PGP</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Feature</th>
                                    <th>S/MIME</th>
                                    <th>PGP / GPG</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Trust model</strong></td>
                                    <td>Hierarchical CA (X.509 certificates)</td>
                                    <td>Web of Trust (decentralized)</td>
                                </tr>
                                <tr>
                                    <td><strong>Key exchange</strong></td>
                                    <td>Certificates issued by CAs; distributed via LDAP/directory</td>
                                    <td>Key servers; manual key exchange</td>
                                </tr>
                                <tr>
                                    <td><strong>Client support</strong></td>
                                    <td>Native in Outlook, Apple Mail, Thunderbird, iOS/Android</td>
                                    <td>Requires plugin (GPG4Win, Enigmail) or dedicated client</td>
                                </tr>
                                <tr>
                                    <td><strong>Enterprise fit</strong></td>
                                    <td>Excellent: integrates with AD, Group Policy, MDM</td>
                                    <td>Limited: manual key management, no centralized policy</td>
                                </tr>
                                <tr>
                                    <td><strong>Complexity</strong></td>
                                    <td>Moderate: requires PKI infrastructure or commercial CA</td>
                                    <td>High: key management burden on individual users</td>
                                </tr>
                                <tr>
                                    <td><strong>Certificate cost</strong></td>
                                    <td>Free (Actalis) to paid (DigiCert, Sectigo)</td>
                                    <td>Free (self-generated keys)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Certificate Pinning -->
                <div class="subsection">
                    <h3 class="subsection-title">Certificate Pinning</h3>
                    <p class="subsection-intro">
                        Certificate pinning restricts which certificates or public keys a client will accept for a given host, providing protection beyond standard CA-based validation. If an attacker obtains a fraudulent certificate from a compromised CA, pinning prevents it from being accepted.
                    </p>

                    <div class="alert alert-warning">
                        <div class="alert-title">HPKP Deprecated</div>
                        <div class="alert-body">
                            HTTP Public Key Pinning (HPKP) was a browser-based pinning mechanism defined in RFC 7469. It was <strong>deprecated in 2018</strong> and removed from Chrome 72 because misconfiguration could permanently brick a domain (pin the wrong key and lose access = site becomes unreachable for the pin's max-age duration). Modern pinning is done at the <strong>application level</strong>, not via HTTP headers.
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Modern Pinning Approaches</h4>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Platform</th>
                                    <th>Mechanism</th>
                                    <th>Configuration</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Android</strong></td>
                                    <td>Network Security Configuration</td>
                                    <td>XML in <code>res/xml/network_security_config.xml</code></td>
                                </tr>
                                <tr>
                                    <td><strong>iOS</strong></td>
                                    <td>TrustKit / NSURLSession delegate</td>
                                    <td>Info.plist configuration or programmatic validation</td>
                                </tr>
                                <tr>
                                    <td><strong>OkHttp (Java/Kotlin)</strong></td>
                                    <td>CertificatePinner</td>
                                    <td>Programmatic via builder API</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Android network_security_config.xml</div>
                            <pre><code><span class="code-comment">&lt;!-- res/xml/network_security_config.xml --&gt;</span>
&lt;network-security-config&gt;
  &lt;domain-config&gt;
    &lt;domain includeSubdomains="true"&gt;
      api.example.com
    &lt;/domain&gt;
    &lt;pin-set expiration="2025-06-01"&gt;
      <span class="code-comment">&lt;!-- Primary pin (leaf or intermediate) --&gt;</span>
      &lt;pin digest="SHA-256"&gt;
        base64-encoded-sha256-of-spki
      &lt;/pin&gt;
      <span class="code-comment">&lt;!-- Backup pin (REQUIRED) --&gt;</span>
      &lt;pin digest="SHA-256"&gt;
        base64-encoded-backup-pin
      &lt;/pin&gt;
    &lt;/pin-set&gt;
  &lt;/domain-config&gt;
&lt;/network-security-config&gt;</code></pre>
                        </div>
                    </div>

                    <div class="alert alert-warning">
                        <div class="alert-title">Always Include a Backup Pin</div>
                        <div class="alert-body">
                            Certificate pinning <strong>requires at least one backup pin</strong> that does not match the currently deployed certificate. If your primary certificate is compromised or expires and you have no backup pin, your application will be unable to connect. Pin to the <strong>intermediate CA's public key</strong> as a backup, or pin to a second leaf certificate stored securely offline.
                        </div>
                    </div>
                </div>

                <!-- Certificate Transparency -->
                <div class="subsection">
                    <h3 class="subsection-title">Certificate Transparency (CT)</h3>
                    <p class="subsection-intro">
                        Certificate Transparency is an open framework (RFC 6962) that makes TLS certificate issuance publicly auditable. CAs must submit every certificate they issue to one or more append-only <strong>CT logs</strong>, creating a public record that domain owners and browsers can monitor for unauthorized issuance.
                    </p>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">How CT Works</h4>

                    <div class="glass-panel">
                        <div class="flow-diagram flow-vertical">
                            <div class="flow-box flow-box-sapphire" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">1. CA Issues Certificate</div>
                                <div class="flow-sub">CA creates the certificate and submits it to CT logs before (pre-certificate) or after issuance</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-emerald" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">2. CT Log Returns SCT</div>
                                <div class="flow-sub">Log appends the certificate and returns a Signed Certificate Timestamp (SCT) as proof of inclusion</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amber" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">3. SCT Delivered to Browser</div>
                                <div class="flow-sub">SCT embedded in the certificate (X.509 extension), TLS handshake, or OCSP stapling response</div>
                            </div>
                            <div class="flow-arrow-down">&darr;</div>
                            <div class="flow-box flow-box-amethyst" style="width: 100%; max-width: 500px;">
                                <div class="flow-label">4. Browser Verifies SCT</div>
                                <div class="flow-sub">Browser checks SCTs are present and valid; Chrome requires SCTs from multiple independent logs</div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <div class="alert-title">Signed Certificate Timestamps (SCTs)</div>
                        <div class="alert-body">
                            An SCT is a cryptographic promise from a CT log that a certificate has been (or will be) incorporated into the log within a Maximum Merge Delay (typically 24 hours). Chrome requires certificates to include SCTs from at least <strong>two independent CT logs</strong> operated by different organizations. Certificates without valid SCTs are treated as untrusted.
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Monitoring with crt.sh</h4>

                    <p>
                        <strong>crt.sh</strong> is a free CT log search engine operated by Sectigo. It aggregates data from all major CT logs and allows searching for certificates by domain name, SHA-256 fingerprint, or issuer. Use it to monitor for unauthorized certificates issued for your domains.
                    </p>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Search CT logs via API</div>
                            <pre><code><span class="code-comment"># Search for all certificates issued for a domain</span>
curl "https://crt.sh/?q=example.com&amp;output=json" \
  | jq '.[] | {id, name_value, not_after, issuer_name}'

<span class="code-comment"># Search for wildcard certificates</span>
curl "https://crt.sh/?q=%25.example.com&amp;output=json" \
  | jq '.[] | {id, name_value}'</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Check SCTs in a live certificate</div>
                            <pre><code><span class="code-comment"># View SCTs embedded in a certificate</span>
openssl s_client -connect example.com:443 \
  -servername example.com 2>/dev/null \
  | openssl x509 -noout -text \
  | grep -A 5 "CT Precertificate SCTs"</code></pre>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <!-- ============================================================
             SECTION 12 — TROUBLESHOOTING
             ============================================================ -->
        <section id="troubleshooting" class="section">
            <div class="section-header">
                <div class="section-number">Section 12</div>
                <h2 class="section-title">Troubleshooting</h2>
                <div class="section-divider"><span class="gem"></span></div>
                <p class="section-description">Common certificate errors, their causes, and how to fix them.</p>
            </div>

            <div class="section-content">

                <!-- certificate verify failed -->
                <div class="subsection">
                    <h3 class="subsection-title">"certificate verify failed"</h3>

                    <div class="alert alert-warning">
                        <div class="alert-title">Error: SSL: CERTIFICATE_VERIFY_FAILED</div>
                        <div class="alert-body">
                            <strong>Cause:</strong> The server's certificate is not trusted by the client. This can mean the CA is not in the trust store, the certificate has expired, or the chain is incomplete (missing intermediates).<br><br>
                            <strong>Debug:</strong>
                        </div>
                    </div>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Diagnose with openssl s_client</div>
                            <pre><code><span class="code-comment"># Connect and inspect the certificate chain</span>
openssl s_client -connect host:443 \
  -servername host 2>&amp;1 | head -30

<span class="code-comment"># Look for:
# - "Verify return code: 0 (ok)" = chain is valid
# - "Verify return code: 20" = unable to get local issuer
# - "Verify return code: 10" = certificate has expired</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Solutions</div>
                            <pre><code><span class="code-comment"># Update system CA bundle</span>
sudo update-ca-certificates     <span class="code-comment"># Debian/Ubuntu</span>
sudo update-ca-trust extract    <span class="code-comment"># RHEL/CentOS</span>

<span class="code-comment"># Specify CA bundle explicitly</span>
curl --cacert /path/to/ca-bundle.crt \
  https://host

<span class="code-comment"># Python: set CA bundle</span>
export REQUESTS_CA_BUNDLE=/path/to/ca.crt</code></pre>
                        </div>
                    </div>
                </div>

                <!-- unable to get local issuer certificate -->
                <div class="subsection">
                    <h3 class="subsection-title">"unable to get local issuer certificate"</h3>

                    <div class="alert alert-warning">
                        <div class="alert-title">Error: unable to get local issuer certificate (depth=0)</div>
                        <div class="alert-body">
                            <strong>Cause:</strong> The server is sending its leaf certificate but <strong>not the intermediate certificate(s)</strong> needed to chain back to a trusted root. The client cannot build the full trust path.<br><br>
                            <strong>Debug:</strong>
                        </div>
                    </div>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Inspect the chain depth</div>
                            <pre><code><span class="code-comment"># Show all certificates the server sends</span>
openssl s_client -connect host:443 \
  -showcerts -servername host 2>&amp;1 \
  | grep -E "^(Certificate chain| [0-9]+ s:)"

<span class="code-comment"># If depth stops at 0, intermediate is missing
# Should show: 0 (leaf) -> 1 (intermediate) -> 2 (root)</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Create fullchain.pem</div>
                            <pre><code><span class="code-comment"># Correct order: leaf first, then intermediate(s)</span>
cat server.crt intermediate.crt > fullchain.pem

<span class="code-comment"># Nginx configuration</span>
ssl_certificate     /etc/ssl/fullchain.pem;
ssl_certificate_key /etc/ssl/private/server.key;

<span class="code-comment"># Apache configuration</span>
SSLCertificateFile    /etc/ssl/server.crt
SSLCertificateChainFile /etc/ssl/intermediate.crt</code></pre>
                        </div>
                    </div>
                </div>

                <!-- certificate has expired -->
                <div class="subsection">
                    <h3 class="subsection-title">"certificate has expired"</h3>

                    <div class="alert alert-warning">
                        <div class="alert-title">Error: certificate has expired (Verify return code: 10)</div>
                        <div class="alert-body">
                            <strong>Cause:</strong> The server's certificate (or an intermediate in the chain) has passed its <code>notAfter</code> date. Alternatively, the <strong>client's system clock</strong> may be incorrect, making a valid certificate appear expired.<br><br>
                            <strong>Debug:</strong>
                        </div>
                    </div>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Check expiration date</div>
                            <pre><code><span class="code-comment"># Check certificate expiration from file</span>
openssl x509 -enddate -noout -in cert.pem

<span class="code-comment"># Check remote server certificate expiration</span>
openssl s_client -connect host:443 \
  -servername host 2>/dev/null \
  | openssl x509 -noout -dates

<span class="code-comment"># Check days until expiration</span>
openssl x509 -checkend 86400 -noout -in cert.pem
<span class="code-comment"># Exit 0 = valid for at least 24h; Exit 1 = expires within 24h</span></code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Solutions</div>
                            <pre><code><span class="code-comment"># Renew with Let's Encrypt</span>
sudo certbot renew

<span class="code-comment"># Check system clock</span>
date -u
timedatectl status

<span class="code-comment"># Sync NTP if clock is wrong</span>
sudo systemctl restart chronyd   <span class="code-comment"># RHEL/CentOS</span>
sudo systemctl restart ntp       <span class="code-comment"># Debian/Ubuntu</span></code></pre>
                        </div>
                    </div>
                </div>

                <!-- hostname mismatch -->
                <div class="subsection">
                    <h3 class="subsection-title">"hostname mismatch"</h3>

                    <div class="alert alert-warning">
                        <div class="alert-title">Error: hostname mismatch / certificate is not valid for the requested host</div>
                        <div class="alert-body">
                            <strong>Cause:</strong> The hostname you are connecting to does not appear in the certificate's Subject Alternative Name (SAN) extension. Browsers and modern TLS libraries <strong>only</strong> check the SAN field, not the Common Name (CN).<br><br>
                            <strong>Debug:</strong>
                        </div>
                    </div>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Check SAN entries</div>
                            <pre><code><span class="code-comment"># View SAN from a certificate file</span>
openssl x509 -in cert.pem -noout -text \
  | grep -A 1 "Subject Alternative Name"

<span class="code-comment"># View SAN from a remote server</span>
openssl s_client -connect host:443 \
  -servername host 2>/dev/null \
  | openssl x509 -noout -ext subjectAltName</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Solution: reissue with correct SANs</div>
                            <pre><code><span class="code-comment"># Generate CSR with multiple SANs</span>
openssl req -new -key server.key \
  -out server.csr \
  -subj "/CN=example.com" \
  -addext "subjectAltName=\
    DNS:example.com,\
    DNS:www.example.com,\
    DNS:api.example.com"</code></pre>
                        </div>
                    </div>
                </div>

                <!-- SAN vs CN -->
                <div class="subsection">
                    <h3 class="subsection-title">SAN vs CN</h3>

                    <div class="alert alert-note">
                        <div class="alert-title">Common Name (CN) Is Deprecated for Hostname Validation</div>
                        <div class="alert-body">
                            RFC 6125 and the CA/Browser Forum Baseline Requirements specify that the <strong>Subject Alternative Name (SAN)</strong> extension is the only field used for hostname matching. The Common Name (CN) in the Subject DN is ignored by modern browsers (Chrome since 2017, Firefox since 2019). All certificates must include a SAN, even for a single hostname. Let's Encrypt and most public CAs automatically include the CN value as a SAN entry.
                        </div>
                    </div>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Check SAN and CN separately</div>
                            <pre><code><span class="code-comment"># Show Subject (CN)</span>
openssl x509 -in cert.pem -noout -subject

<span class="code-comment"># Show SAN extension</span>
openssl x509 -in cert.pem -noout \
  -ext subjectAltName

<span class="code-comment"># Show both in one command</span>
openssl x509 -in cert.pem -noout -text \
  | grep -E "(Subject:|DNS:)" | head -5</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Clock Skew -->
                <div class="subsection">
                    <h3 class="subsection-title">Clock Skew</h3>
                    <p class="subsection-intro">
                        Certificate validation depends on accurate system time. If the client's clock is significantly wrong, valid certificates may appear expired (<code>notAfter</code> in the past) or not yet valid (<code>notBefore</code> in the future). Clock skew is a common cause of certificate errors on embedded devices, VMs, and freshly provisioned servers.
                    </p>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">NTP synchronization (Linux)</div>
                            <pre><code><span class="code-comment"># Check current time source (chrony)</span>
chronyc tracking
chronyc sources -v

<span class="code-comment"># Force immediate sync</span>
sudo chronyc makestep

<span class="code-comment"># Restart chrony service</span>
sudo systemctl restart chronyd

<span class="code-comment"># Alternative: ntpd</span>
ntpq -p
sudo systemctl restart ntp</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">NTP synchronization (Windows)</div>
                            <pre><code><span class="code-comment">:: Check Windows time service status</span>
w32tm /query /status

<span class="code-comment">:: Force resync</span>
w32tm /resync /force

<span class="code-comment">:: Show time source</span>
w32tm /query /source

<span class="code-comment">:: Configure NTP server</span>
w32tm /config /manualpeerlist:"pool.ntp.org" \
  /syncfromflags:manual /update</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Intermediate Missing from Chain -->
                <div class="subsection">
                    <h3 class="subsection-title">Intermediate Missing from Chain</h3>
                    <p class="subsection-intro">
                        The most common TLS misconfiguration is a server that sends only its leaf certificate without the intermediate CA certificate(s). Some clients (notably desktop browsers) work around this with AIA fetching, but most tools (curl, OpenSSL, Python, Java) will fail with "unable to get local issuer certificate."
                    </p>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Detect missing intermediates</div>
                            <pre><code><span class="code-comment"># Check chain completeness</span>
openssl s_client -connect host:443 \
  -servername host 2>&amp;1 \
  | grep "verify error"

<span class="code-comment"># Show full chain with certificate subjects</span>
openssl s_client -connect host:443 \
  -showcerts -servername host 2>/dev/null \
  | grep "s:" | head -5

<span class="code-comment"># Download missing intermediate from AIA</span>
openssl x509 -in leaf.crt -noout -text \
  | grep "CA Issuers" \
  | sed 's/.*URI://'</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Build fullchain.pem</div>
                            <pre><code><span class="code-comment"># Order: server cert FIRST, then intermediate(s)
# Do NOT include the root CA</span>
cat server.crt intermediate.crt > fullchain.pem

<span class="code-comment"># Verify the chain</span>
openssl verify -CAfile /etc/ssl/certs/ca-certificates.crt \
  -untrusted intermediate.crt server.crt</code></pre>
                        </div>
                    </div>

                    <h4 style="font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--amber); margin-bottom: var(--space-3); margin-top: var(--space-5);">Web Server Configuration</h4>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Nginx</div>
                            <pre><code>server {
    listen 443 ssl;
    server_name example.com;

    <span class="code-comment"># fullchain.pem = server.crt + intermediate.crt</span>
    ssl_certificate     /etc/ssl/fullchain.pem;
    ssl_certificate_key /etc/ssl/private/server.key;
}</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Apache</div>
                            <pre><code>&lt;VirtualHost *:443&gt;
    ServerName example.com

    SSLCertificateFile      /etc/ssl/server.crt
    SSLCertificateKeyFile   /etc/ssl/private/server.key
    SSLCertificateChainFile /etc/ssl/intermediate.crt
&lt;/VirtualHost&gt;</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Java Truststore Issues -->
                <div class="subsection">
                    <h3 class="subsection-title">Java Truststore Issues</h3>
                    <p class="subsection-intro">
                        Java applications use a dedicated trust store (<code>cacerts</code>) rather than the operating system's CA bundle. This means a certificate trusted by curl or a browser may still fail in Java if the CA is not in the JVM's trust store.
                    </p>

                    <div class="alert alert-warning">
                        <div class="alert-title">PKIX path building failed</div>
                        <div class="alert-body">
                            The error <code>sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target</code> means the server's CA certificate is not in Java's <code>cacerts</code> trust store. This is the most common Java TLS error and affects any Java application making HTTPS connections (Spring Boot, Maven, Gradle, Jenkins, etc.).
                        </div>
                    </div>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Locate and inspect cacerts</div>
                            <pre><code><span class="code-comment"># Default location (Java 9+)</span>
$JAVA_HOME/lib/security/cacerts

<span class="code-comment"># Default location (Java 8 and earlier)</span>
$JAVA_HOME/jre/lib/security/cacerts

<span class="code-comment"># Default password: "changeit"</span>

<span class="code-comment"># List all trusted CAs</span>
keytool -list -keystore \
  $JAVA_HOME/lib/security/cacerts \
  -storepass changeit | head -20

<span class="code-comment"># Search for a specific CA</span>
keytool -list -keystore \
  $JAVA_HOME/lib/security/cacerts \
  -storepass changeit \
  | grep -i "letsencrypt"</code></pre>
                        </div>
                        <div class="command-card">
                            <div class="command-card-label">Import a CA certificate</div>
                            <pre><code><span class="code-comment"># Import CA cert into Java trust store</span>
keytool -import -trustcacerts \
  -alias myca \
  -file ca.crt \
  -keystore $JAVA_HOME/lib/security/cacerts \
  -storepass changeit

<span class="code-comment"># Verify import</span>
keytool -list -alias myca \
  -keystore $JAVA_HOME/lib/security/cacerts \
  -storepass changeit</code></pre>
                        </div>
                    </div>

                    <div class="command-grid">
                        <div class="command-card">
                            <div class="command-card-label">Enable SSL debugging</div>
                            <pre><code><span class="code-comment"># Full SSL debug output</span>
java -Djavax.net.debug=ssl:handshake \
  -jar myapp.jar

<span class="code-comment"># More targeted debugging</span>
java -Djavax.net.debug=ssl:handshake:verbose \
  -jar myapp.jar

<span class="code-comment"># Specify custom trust store at runtime</span>
java -Djavax.net.ssl.trustStore=/path/to/custom-cacerts \
  -Djavax.net.ssl.trustStorePassword=changeit \
  -jar myapp.jar</code></pre>
                        </div>
                    </div>

                    <div class="alert alert-note">
                        <div class="alert-title">Common Java Truststore Gotchas</div>
                        <div class="alert-body">
                            <strong>Wrong JAVA_HOME:</strong> Multiple JDK/JRE installations may exist; verify <code>which java</code> and <code>java -XshowSettings:property 2>&amp;1 | grep java.home</code> point to the same JVM whose cacerts you modified.<br>
                            <strong>Permission denied:</strong> The cacerts file is owned by root; use <code>sudo</code> when importing certificates.<br>
                            <strong>Wrong password:</strong> The default password is <code>changeit</code>; if it was changed, the import will fail silently or throw an exception.<br>
                            <strong>JVM restart required:</strong> cacerts is loaded at JVM startup; after importing a certificate, restart the Java application.
                        </div>
                    </div>
                </div>

                <!-- Debugging Tools Summary -->
                <div class="subsection">
                    <h3 class="subsection-title">Debugging Tools Summary</h3>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Tool</th>
                                    <th>Command</th>
                                    <th>What It Shows</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>openssl s_client</strong></td>
                                    <td><code>openssl s_client -connect host:443</code></td>
                                    <td>TLS handshake details, certificate chain, cipher negotiation, verify result</td>
                                </tr>
                                <tr>
                                    <td><strong>openssl verify</strong></td>
                                    <td><code>openssl verify -CAfile ca.crt cert.crt</code></td>
                                    <td>Offline chain validation against a specified CA bundle</td>
                                </tr>
                                <tr>
                                    <td><strong>openssl x509</strong></td>
                                    <td><code>openssl x509 -in cert.pem -text</code></td>
                                    <td>Full certificate details: subject, issuer, SAN, key usage, validity dates</td>
                                </tr>
                                <tr>
                                    <td><strong>curl -v</strong></td>
                                    <td><code>curl -v https://host</code></td>
                                    <td>Full TLS negotiation including protocol version, cipher, and certificate info</td>
                                </tr>
                                <tr>
                                    <td><strong>keytool</strong></td>
                                    <td><code>keytool -list -keystore cacerts</code></td>
                                    <td>Java truststore contents: aliases, fingerprints, expiration dates</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </section>

        <!-- Footer -->
        <div class="divider">
            <div class="divider-line"></div>
            <div class="divider-center">
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
                <div class="divider-gem"></div>
            </div>
            <div class="divider-line"></div>
        </div>

        <footer class="site-footer">
            <p>PKI &amp; Certificates &mdash; A Tech Guide</p>
            <a href="index.html">Back to Tech Guides</a>
        </footer>

    </div>
</body>
</html>
